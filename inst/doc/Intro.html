<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Xixu Hu, xixuhu1998@gmail.com" />

<meta name="date" content="2019-12-27" />

<title>SC19090</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />




</head>

<body>




<h1 class="title toc-ignore">SC19090</h1>
<h4 class="author">Xixu Hu, <a href="mailto:xixuhu1998@gmail.com">xixuhu1998@gmail.com</a></h4>
<h4 class="date">December 27, 2019</h4>


<div id="TOC">
<ul>
<li><a href="#section-1-illustration-of-the-usage-of-my-functions">Section 1: Illustration of the usage of my functions</a><ul>
<li><a href="#jonckheere-terpstra-test">Jonckheere-Terpstra Test</a></li>
<li><a href="#functions-for-solving-confidence-interval">Functions for solving confidence interval</a></li>
</ul></li>
<li><a href="#section-2-answers-for-all-the-homework">Section 2: Answers for all the homework</a><ul>
<li><a href="#homework-1-9.20">Homework-1 9.20</a></li>
<li><a href="#homework-2-9.29">Homework-2 9.29</a></li>
<li><a href="#homework-3-10.11">Homework-3 10.11</a></li>
<li><a href="#homework-4-10.18">Homework-4 10.18</a></li>
<li><a href="#homework-5-11.1">Homework-5 11.1</a></li>
<li><a href="#homework-6-11.8">Homework-6 11.8</a></li>
<li><a href="#homework-7-11.15">Homework-7 11.15</a></li>
<li><a href="#homework-9-11.29">Homework-9 11.29</a></li>
<li><a href="#homework-10-12.6">Homework-10 12.6</a></li>
<li><a href="#homework-11-12.13">Homework-11 12.13</a></li>
<li><a href="#homework-12-12.20">Homework-12 12.20</a></li>
</ul></li>
</ul>
</div>

<p><font size="4" face="Cambria"></p>
<div id="section-1-illustration-of-the-usage-of-my-functions" class="section level2">
<h2>Section 1: Illustration of the usage of my functions</h2>
<div id="jonckheere-terpstra-test" class="section level3">
<h3>Jonckheere-Terpstra Test</h3>
<p>Jonckheere-Terpstra test is a nonparametric test used to test the location parameters of multi-group data. We can easily implement the test using <em>jonckheere.test</em> function in <em>clinfun</em> package. However, it will report warnings if the input data has ties. See the example below:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(clinfun,<span class="dt">quietly =</span> <span class="ot">TRUE</span>)
medical=<span class="kw">c</span>(<span class="dv">125</span>,<span class="dv">136</span>,<span class="dv">116</span>,<span class="dv">101</span>,<span class="dv">105</span>,<span class="dv">109</span>,
<span class="dv">122</span>,<span class="dv">114</span>,<span class="dv">132</span>,<span class="dv">120</span>,<span class="dv">119</span>,<span class="dv">127</span>,
<span class="dv">128</span>,<span class="dv">142</span>,<span class="dv">128</span>,<span class="dv">134</span>,<span class="dv">135</span>,<span class="dv">132</span>,<span class="dv">140</span>,<span class="dv">129</span>)
gr.medical=<span class="kw">c</span>(<span class="kw">rep</span>(<span class="dv">1</span>,<span class="dv">6</span>),<span class="kw">rep</span>(<span class="dv">2</span>,<span class="dv">6</span>),<span class="kw">rep</span>(<span class="dv">3</span>,<span class="dv">8</span>))
<span class="kw">jonckheere.test</span>(medical,gr.medical)</code></pre></div>
<pre><code># Warning in jonckheere.test(medical, gr.medical): Sample size &gt; 100 or data with ties 
#  p-value based on normal approximation. Specify nperm for permutation p-value</code></pre>
<pre><code># 
#   Jonckheere-Terpstra test
# 
# data:  
# JT = 111.5, p-value = 0.001564
# alternative hypothesis: two.sided</code></pre>
<p>Therefore, I rewrote an extended version of <em>jonckheere.test</em>, which can automatically detect the existence of ties in the data and call the corresponding function.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(m)
<span class="kw">attach</span>(m)
<span class="kw">jh_extend</span>(medical,gr)</code></pre></div>
<pre><code># 
#         Jonckheere-Terpstra test (data with ties)        
# 
# data:
# JT =  111.5 , p-value =  0.000775</code></pre>
<pre><code># $JT
# [1] 111.5
# 
# $p.value
# [1] 0.000775</code></pre>
</div>
<div id="functions-for-solving-confidence-interval" class="section level3">
<h3>Functions for solving confidence interval</h3>
<p>I also wrote two functions to solve the confidence interval of sample mean by methods of <strong>empirical likelihood method</strong> and <strong>nonparametric delta method</strong>. Consider such an example:</p>
<p>Suppose the mean value for X is zero. For samples <span class="math inline">\(X_1,...,X_n\)</span>, use <strong>empirical likelihood method</strong> and <strong>nonparametric delta method</strong> to get the 95% confidence interval for <span class="math inline">\(Var(X)\)</span>. Sample from normal distribution and compare the results under n=500,5000,50000.</p>
<p>Then, we can solve the prolem by using functions <strong>CI_ELR</strong> and <em>CI_NDM</em></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">7524</span>)
n=<span class="kw">c</span>(<span class="dv">500</span>,<span class="dv">5000</span>,<span class="dv">50000</span>)
int=<span class="kw">matrix</span>(<span class="dv">0</span>,<span class="dt">ncol=</span><span class="dv">2</span>,<span class="dt">nrow=</span><span class="dv">3</span>)
lik=<span class="kw">matrix</span>(<span class="dv">0</span>,<span class="dt">ncol=</span><span class="dv">2</span>,<span class="dt">nrow=</span><span class="dv">3</span>)
<span class="kw">rownames</span>(int)=<span class="kw">rownames</span>(lik)=<span class="kw">paste</span>(<span class="st">&quot;n=&quot;</span>,n)
<span class="kw">colnames</span>(int)=<span class="kw">colnames</span>(lik)=<span class="kw">c</span>(<span class="st">&quot;left&quot;</span>,<span class="st">&quot;right&quot;</span>)
up=<span class="kw">c</span>(<span class="fl">1.23</span>,<span class="fl">1.07</span>,<span class="fl">1.07</span>)
<span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>){
 x=<span class="kw">rnorm</span>(n[i])
 y=x<span class="op">^</span><span class="dv">2</span> <span class="co">#turn var into mean</span>
 int[i,]=<span class="kw">CI_NDM</span>(y,<span class="fl">0.05</span>)
 lik[i,]=<span class="kw">CI_ELR</span>(y,<span class="fl">0.05</span>,up[i])
}
<span class="kw">print</span>(<span class="st">&quot;95% Confidence Interval for Nonparametric Delta Method&quot;</span>);int</code></pre></div>
<pre><code># [1] &quot;95% Confidence Interval for Nonparametric Delta Method&quot;</code></pre>
<pre><code>#            left  right
# n= 500   0.9069 1.1496
# n= 5000  0.9432 1.0222
# n= 50000 0.9977 1.0226</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">print</span>(<span class="st">&quot;95% Confidence Interval for Empirical Likelihood Ratio&quot;</span>);lik</code></pre></div>
<pre><code># [1] &quot;95% Confidence Interval for Empirical Likelihood Ratio&quot;</code></pre>
<pre><code>#            left  right
# n= 500   0.9130 1.1663
# n= 5000  0.9442 1.0237
# n= 50000 0.9978 1.0227</code></pre>
</div>
</div>
<div id="section-2-answers-for-all-the-homework" class="section level2">
<h2>Section 2: Answers for all the homework</h2>
<div id="homework-1-9.20" class="section level3">
<h3>Homework-1 9.20</h3>
<div id="question-use-knitr-to-produce-texts-figures-and-tables." class="section level4">
<h4>Question: Use knitr to produce texts, figures and tables.</h4>
</div>
<div id="answers" class="section level4">
<h4>Answers:</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(lattice)
<span class="kw">library</span>(dplyr)
<span class="kw">library</span>(knitr)</code></pre></div>
</div>
<div id="texts" class="section level4">
<h4>1.Texts:</h4>
<p>  This is my first homework for this year Statistical Computing. I wrote this paragraph to show the use of texts in “knitr”. We always end a line with two spaces.<br />
  We use two star to have italic form: <em>Happy</em> and we use two stars to have bold one: <strong>Happy</strong>. What’s more, if you want the delete line style,you can use tilde: <del>This is the delete line form</del><br />
  We can also display math formula in this form <span class="math inline">\(a^2+b^2=c^2\)</span></p>
</div>
<div id="figures" class="section level4">
<h4>2.Figures:</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">n &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">5</span>, <span class="dv">45</span>, <span class="dv">5</span>)
x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="kw">sum</span>(n))
y &lt;-<span class="st"> </span><span class="kw">factor</span>(<span class="kw">rep</span>(n, n), <span class="dt">labels=</span><span class="kw">paste</span>(<span class="st">&quot;n =&quot;</span>, n))
<span class="kw">densityplot</span>(<span class="op">~</span><span class="st"> </span>x <span class="op">|</span><span class="st"> </span>y,
<span class="dt">panel =</span> <span class="cf">function</span>(x, ...) {
<span class="kw">panel.densityplot</span>(x, <span class="dt">col=</span><span class="st">&quot;DarkOliveGreen&quot;</span>, ...)
<span class="kw">panel.mathdensity</span>(<span class="dt">dmath=</span>dnorm,
<span class="dt">args=</span><span class="kw">list</span>(<span class="dt">mean=</span><span class="kw">mean</span>(x), <span class="dt">sd=</span><span class="kw">sd</span>(x)),
<span class="dt">col=</span><span class="st">&quot;darkblue&quot;</span>)
})</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="tables" class="section level4">
<h4>3.Tables:</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dt &lt;-<span class="st"> </span>mtcars[<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">6</span>]
<span class="kw">kable</span>(dt)</code></pre></div>
<table>
<thead>
<tr class="header">
<th></th>
<th align="right">mpg</th>
<th align="right">cyl</th>
<th align="right">disp</th>
<th align="right">hp</th>
<th align="right">drat</th>
<th align="right">wt</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Mazda RX4</td>
<td align="right">21.0</td>
<td align="right">6</td>
<td align="right">160</td>
<td align="right">110</td>
<td align="right">3.90</td>
<td align="right">2.620</td>
</tr>
<tr class="even">
<td>Mazda RX4 Wag</td>
<td align="right">21.0</td>
<td align="right">6</td>
<td align="right">160</td>
<td align="right">110</td>
<td align="right">3.90</td>
<td align="right">2.875</td>
</tr>
<tr class="odd">
<td>Datsun 710</td>
<td align="right">22.8</td>
<td align="right">4</td>
<td align="right">108</td>
<td align="right">93</td>
<td align="right">3.85</td>
<td align="right">2.320</td>
</tr>
<tr class="even">
<td>Hornet 4 Drive</td>
<td align="right">21.4</td>
<td align="right">6</td>
<td align="right">258</td>
<td align="right">110</td>
<td align="right">3.08</td>
<td align="right">3.215</td>
</tr>
<tr class="odd">
<td>Hornet Sportabout</td>
<td align="right">18.7</td>
<td align="right">8</td>
<td align="right">360</td>
<td align="right">175</td>
<td align="right">3.15</td>
<td align="right">3.440</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="homework-2-9.29" class="section level3">
<h3>Homework-2 9.29</h3>
<div id="section" class="section level4">
<h4>3.4</h4>
<p>Develop an algorithm to generate random samples from a Rayleigh(σ) distribution with different values of sigma. Using histogram to check the mode of the generated samples is close to the theoretical mode <span class="math inline">\(\sigma\)</span>.</p>
</div>
<div id="answers-1" class="section level4">
<h4>Answers:</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">cbPalette =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;#999999&quot;</span>, <span class="st">&quot;#E69F00&quot;</span>, <span class="st">&quot;#56B4E9&quot;</span>, <span class="st">&quot;#009E73&quot;</span>, <span class="st">&quot;#F0E442&quot;</span>, <span class="st">&quot;#0072B2&quot;</span>, 
              <span class="st">&quot;#D55E00&quot;</span>, <span class="st">&quot;#CC79A7&quot;</span>)
gen_Raylei=<span class="st"> </span><span class="cf">function</span>(sigma){
 n =<span class="st"> </span><span class="dv">1000</span>;
 u =<span class="st"> </span><span class="kw">runif</span>(n);
 x =<span class="st"> </span><span class="kw">sqrt</span>(<span class="op">-</span><span class="dv">2</span><span class="op">*</span>sigma<span class="op">^</span><span class="dv">2</span><span class="op">*</span><span class="kw">log</span>(<span class="dv">1</span><span class="op">-</span>u));
 <span class="kw">hist</span>(x, <span class="dt">prob =</span> <span class="ot">TRUE</span>,<span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="fl">0.65</span>),<span class="dt">main=</span><span class="kw">paste</span>(<span class="st">&quot;Sigma = &quot;</span>,sigma))
 y =<span class="st"> </span><span class="kw">seq</span>(<span class="dv">0</span>,<span class="kw">ceiling</span>(<span class="kw">max</span>(x)),.<span class="dv">01</span>)
 <span class="kw">lines</span>(y,y<span class="op">/</span>sigma<span class="op">^</span><span class="dv">2</span><span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>y<span class="op">^</span><span class="dv">2</span><span class="op">/</span><span class="dv">2</span><span class="op">/</span>sigma<span class="op">^</span><span class="dv">2</span>),<span class="dt">col=</span>cbPalette[sigma],<span class="dt">lwd=</span><span class="dv">2</span>)
}
<span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))
<span class="cf">for</span> (sigma <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>){
 <span class="kw">gen_Raylei</span>(sigma)
}</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --></p>
<p>I use the inverse transform method to generate the random numbers. It can be clearly seen that the mode of simulation is close to the theorectical mode <span class="math inline">\(\sigma\)</span>.</p>
</div>
<div id="section-1" class="section level4">
<h4>3.11</h4>
<p>Generate a random sample of size 1000 from a normal location mixture. Graph the histogram of the sample with density superimposed, for <span class="math inline">\(p_1 = 0.75\)</span>. Repeat with different values for <span class="math inline">\(p_1\)</span> and observe whether the empirical distribution of the mixture appears to be bimodal. Make a conjecture about the values of <span class="math inline">\(p_1\)</span> that produce bimodal mixtures.</p>
</div>
<div id="answers-2" class="section level4">
<h4>Answers:</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">gen_Mixnorm =<span class="st"> </span><span class="cf">function</span>(p1){
 n =<span class="st"> </span><span class="fl">1e4</span>
 X1 =<span class="st"> </span><span class="kw">rnorm</span>(n,<span class="dv">0</span>,<span class="dv">1</span>)
 X2 =<span class="st"> </span><span class="kw">rnorm</span>(n,<span class="dv">3</span>,<span class="dv">1</span>)
 r =<span class="st"> </span><span class="kw">sample</span>(<span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),n,<span class="dt">prob=</span><span class="kw">c</span>(<span class="dv">1</span><span class="op">-</span>p1,p1),<span class="dt">replace=</span><span class="ot">TRUE</span>)
 Z =<span class="st"> </span>r<span class="op">*</span>X1<span class="op">+</span>(<span class="dv">1</span><span class="op">-</span>r)<span class="op">*</span>X2
 <span class="kw">hist</span>(Z,<span class="dt">prob=</span><span class="ot">TRUE</span>,<span class="dt">main=</span><span class="kw">paste</span>(p1,<span class="st">&quot;X1+&quot;</span>,<span class="dv">1</span><span class="op">-</span>p1,<span class="st">&quot;X2&quot;</span>),<span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="fl">0.8</span>))
 y =<span class="st"> </span><span class="kw">seq</span>(<span class="op">-</span><span class="dv">4</span>,<span class="dv">6</span>,.<span class="dv">01</span>)
 <span class="kw">lines</span>(y,p1<span class="op">*</span><span class="kw">dnorm</span>(y,<span class="dv">0</span>,<span class="dv">1</span>)<span class="op">+</span>(<span class="dv">1</span><span class="op">-</span>p1)<span class="op">*</span><span class="kw">dnorm</span>(y,<span class="dv">3</span>,<span class="dv">1</span>),<span class="dt">col=</span>cbPalette[<span class="kw">sample</span>(<span class="kw">seq</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">8</span>),<span class="dv">1</span>,<span class="dt">replace=</span>F)],<span class="dt">lwd=</span><span class="dv">2</span>)
}
<span class="kw">par</span>(<span class="dt">mfrow=</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>)))
<span class="kw">gen_Mixnorm</span>(<span class="fl">0.25</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">gen_Mixnorm</span>(<span class="fl">0.5</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">gen_Mixnorm</span>(<span class="fl">0.75</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">gen_Mixnorm</span>(<span class="dv">1</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>When <span class="math inline">\(p_1=0.5\)</span>, the mixture appears to be bimodal.</p>
</div>
<div id="section-2" class="section level4">
<h4>3.18</h4>
<p>Write a function to generate a random sample from a <span class="math inline">\(W_d(\Sigma,n)\)</span> (Wishart) distribution for <span class="math inline">\(n&gt;d+1\geq 1\)</span>, based on Bartlett’s decomposition.</p>
</div>
<div id="answers-3" class="section level4">
<h4>Answers:</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">gen_Wisha =<span class="st"> </span><span class="cf">function</span> (d,n,Sigma){
 T=<span class="kw">matrix</span>(<span class="dv">0</span>,<span class="dt">nrow=</span>d,<span class="dt">ncol=</span>d)
 <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>d){
  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>d){
   <span class="cf">if</span> (i<span class="op">&gt;</span>j) T[i,j]=<span class="kw">rnorm</span>(<span class="dv">1</span>)
   <span class="cf">else</span> <span class="cf">if</span> (i<span class="op">==</span>j) T[i,i]=<span class="kw">sqrt</span>(<span class="kw">rchisq</span>(<span class="dv">1</span>,n<span class="op">-</span>i<span class="op">+</span><span class="dv">1</span>))
        <span class="cf">else</span> <span class="cf">next</span>
  }
 }
 L=<span class="kw">t</span>(<span class="kw">chol</span>(Sigma)) <span class="co">#Choleski decomposition</span>
 <span class="kw">return</span>(L<span class="op">%*%</span>T<span class="op">%*%</span><span class="kw">t</span>(T)<span class="op">%*%</span><span class="kw">t</span>(L))
}
Sigma=<span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">4</span>),<span class="dt">nrow=</span><span class="dv">2</span>)
<span class="kw">gen_Wisha</span>(<span class="dv">2</span>,<span class="dv">5</span>,Sigma)</code></pre></div>
<pre><code>#          [,1]     [,2]
# [1,] 22.13380 22.99182
# [2,] 22.99182 25.84665</code></pre>
<p>I choose the sample as a <span class="math inline">\(W_2(5,\Sigma)\)</span>,<span class="math inline">\(\Sigma=\bigl( \begin{smallmatrix} 3 &amp; 2\\ 2&amp; 4 \end{smallmatrix} \bigr)\)</span>, which satisfies <span class="math inline">\(5&gt;2+1\geq 1\)</span>. The function can be further tested in more complex samples.</p>
</div>
</div>
<div id="homework-3-10.11" class="section level3">
<h3>Homework-3 10.11</h3>
<div id="section-3" class="section level4">
<h4>5.1</h4>
<p>Compute a Monte Carlo estimate of <span class="math display">\[\int_{0}^{\frac{\pi}{3}}sintdt\]</span> and compare your estimate with the exact value of the integral.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">1234</span>)
m =<span class="st"> </span><span class="fl">1e4</span>;
x =<span class="st"> </span><span class="kw">runif</span>(m,<span class="dt">min=</span><span class="dv">0</span>,<span class="dt">max=</span>pi<span class="op">/</span><span class="dv">3</span>)
theta.hat =<span class="st"> </span><span class="kw">mean</span>(<span class="kw">sin</span>(x)<span class="op">*</span>pi<span class="op">/</span><span class="dv">3</span>)
re=<span class="kw">matrix</span>(<span class="kw">c</span>(theta.hat,<span class="kw">cos</span>(<span class="dv">0</span>)<span class="op">-</span><span class="kw">cos</span>(pi<span class="op">/</span><span class="dv">3</span>)),<span class="dt">nrow=</span><span class="dv">1</span>)
re=<span class="kw">round</span>(re,<span class="dv">4</span>)
<span class="kw">colnames</span>(re)=<span class="kw">c</span>(<span class="st">&quot;Estimate&quot;</span>,<span class="st">&quot;Exact Value&quot;</span>)
re</code></pre></div>
<pre><code>#      Estimate Exact Value
# [1,]   0.5006         0.5</code></pre>
<p>The difference between estimation and exact value is 0.0006, which is acceptable.</p>
</div>
<div id="section-4" class="section level4">
<h4>5.10</h4>
<p>Use Monte Carlo integration with antithetic variables to estimate <span class="math display">\[\int_{0}^{1}\frac{e^{-x}}{1+x^2}dx\]</span> and find the approximate reduction in variance as a percentage of the variance without variance reduction.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">2222</span>)
MC.Phi &lt;-<span class="st"> </span><span class="cf">function</span>(<span class="dt">R =</span> <span class="fl">1e4</span>, <span class="dt">anti =</span> <span class="ot">TRUE</span>) {
  u &lt;-<span class="st"> </span><span class="kw">runif</span>(R<span class="op">/</span><span class="dv">2</span>)
  <span class="cf">if</span> (<span class="op">!</span>anti) v &lt;-<span class="st"> </span><span class="kw">runif</span>(R<span class="op">/</span><span class="dv">2</span>) <span class="cf">else</span> v &lt;-<span class="st"> </span>(<span class="dv">1</span><span class="op">-</span>u)
  u &lt;-<span class="st"> </span><span class="kw">c</span>(u, v)
  MC =<span class="st"> </span><span class="kw">mean</span>(<span class="kw">exp</span>(<span class="op">-</span>u)<span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>u<span class="op">^</span><span class="dv">2</span>))
  <span class="kw">return</span>(MC)
  }
m=<span class="dv">1000</span>;
MC.de=MC=<span class="kw">numeric</span>(m)
<span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){
 MC.de[i]=<span class="kw">MC.Phi</span>(<span class="dt">R=</span><span class="dv">1000</span>)
 MC[i]=<span class="kw">MC.Phi</span>(<span class="dt">R=</span><span class="dv">1000</span>,<span class="dt">anti=</span><span class="ot">FALSE</span>)
}
<span class="kw">print</span>(<span class="st">&quot;Approximate reduction in variance: &quot;</span>)</code></pre></div>
<pre><code># [1] &quot;Approximate reduction in variance: &quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(<span class="kw">var</span>(MC)<span class="op">-</span><span class="kw">var</span>(MC.de))<span class="op">/</span><span class="kw">var</span>(MC)</code></pre></div>
<pre><code># [1] 0.9664172</code></pre>
<p>Using antithetic variables, the variance is reduced by 97%.</p>
</div>
<div id="section-5" class="section level4">
<h4>5.15</h4>
<p>Obtain the stratified importance sampling estimate in Example 5.13 and compare it with the result of Example 5.10. The integral is the same as 5.10: <span class="math display">\[\int_{0}^{1}\frac{e^{-x}}{1+x^2}dx\]</span></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">5678</span>)
M =<span class="st"> </span><span class="fl">1e4</span>; k =<span class="st"> </span><span class="dv">5</span> 
r =<span class="st"> </span>M<span class="op">/</span>k             <span class="co">#replicates per stratum</span>
N =<span class="st"> </span><span class="dv">50</span>              <span class="co">#number of times to repeat the estimation</span>
T2 =<span class="st"> </span><span class="kw">numeric</span>(k)     <span class="co">#Store the results of each stratum</span>
est =<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>, N, <span class="dv">2</span>)
g =<span class="st"> </span><span class="cf">function</span>(x)<span class="kw">exp</span>(<span class="op">-</span>x)<span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>x<span class="op">^</span><span class="dv">2</span>)<span class="op">*</span>(x<span class="op">&gt;</span><span class="dv">0</span>)<span class="op">*</span>(x<span class="op">&lt;</span><span class="dv">1</span>) 
f1 =<span class="st"> </span><span class="cf">function</span>(x)<span class="kw">exp</span>(<span class="op">-</span>x)<span class="op">/</span>(<span class="dv">1</span><span class="op">-</span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span>))
f2 =<span class="st"> </span><span class="cf">function</span>(x)<span class="kw">exp</span>(<span class="op">-</span>x)<span class="op">/</span>(<span class="kw">exp</span>(<span class="op">-</span>(j<span class="op">-</span><span class="dv">1</span>)<span class="op">/</span>k)<span class="op">-</span><span class="kw">exp</span>(<span class="op">-</span>j<span class="op">/</span>k))

<span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N) {
  u =<span class="st"> </span><span class="kw">runif</span>(M);x =<span class="st"> </span><span class="op">-</span><span class="kw">log</span>(<span class="dv">1</span><span class="op">-</span>u<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span>))) <span class="co">#u~U[0,1]; inverse trans; </span>
  est[i, <span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">mean</span>(<span class="kw">g</span>(x)<span class="op">/</span><span class="kw">f1</span>(x))            
  <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>k){
   u =<span class="st"> </span><span class="kw">runif</span>(r)  
   x =<span class="st"> </span><span class="op">-</span><span class="kw">log</span>(<span class="kw">exp</span>(<span class="op">-</span>(j<span class="op">-</span><span class="dv">1</span>)<span class="op">/</span>k)<span class="op">-</span>(<span class="kw">exp</span>(<span class="op">-</span>(j<span class="op">-</span><span class="dv">1</span>)<span class="op">/</span>k)<span class="op">-</span><span class="kw">exp</span>(<span class="op">-</span>j<span class="op">/</span>k))<span class="op">*</span>u) 
   T2[j]&lt;-<span class="kw">mean</span>(<span class="dv">5</span><span class="op">*</span><span class="kw">g</span>(x)<span class="op">/</span><span class="kw">f2</span>(x))
  }
  est[i,<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">mean</span>(T2)
}
re =<span class="st"> </span><span class="kw">cbind</span>(<span class="kw">apply</span>(est,<span class="dv">2</span>,mean),<span class="kw">apply</span>(est,<span class="dv">2</span>,sd))
<span class="kw">rownames</span>(re)=<span class="kw">c</span>(<span class="st">&quot;Important Sampling&quot;</span>,<span class="st">&quot;Im Sa + Str Sa&quot;</span>)
<span class="kw">colnames</span>(re)=<span class="kw">c</span>(<span class="st">&quot;theta_hat&quot;</span>,<span class="st">&quot;sd&quot;</span>)
knitr<span class="op">::</span><span class="kw">kable</span>(re)</code></pre></div>
<table>
<thead>
<tr class="header">
<th></th>
<th align="right">theta_hat</th>
<th align="right">sd</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Important Sampling</td>
<td align="right">0.5248071</td>
<td align="right">0.0008851</td>
</tr>
<tr class="even">
<td>Im Sa + Str Sa</td>
<td align="right">0.5247607</td>
<td align="right">0.0001927</td>
</tr>
</tbody>
</table>
<p>It can be seen that the standard error of stratified important sampling is 1/5 of the standard error of important sampling.</p>
</div>
</div>
<div id="homework-4-10.18" class="section level3">
<h3>Homework-4 10.18</h3>
<div id="section-6" class="section level4">
<h4>6.5</h4>
<p>Use a Monte Carlo experiment to estimate the <strong>coverage probability</strong> of the t-interval for random samples of <span class="math inline">\(\chi^2(2)\)</span> data with sample size <span class="math inline">\(n = 20\)</span>. Compare your t-interval results with the simulation results in Example 6.4. <span class="math inline">\(E(\chi^2(2))=2\quad Var(\chi^2(x))=4\)</span></p>
<p>Coverage Probability: <span class="math display">\[\frac{1}{m}\sum_{i=1}^{m}I(\bar{X}-t_{0.975,n-1}\frac{sd(X)}{\sqrt{n}}&lt;2&lt;\bar{X}+t_{0.975,n-1}\frac{sd(X)}{\sqrt{n}})\]</span> <span class="math display">\[\frac{1}{m}\sum_{i=1}^{m}I(\frac{(n-1)Var(X)}{\chi^2_{0.05}}&gt;4)\]</span></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">n=<span class="dv">20</span>;m=<span class="dv">1000</span>
<span class="kw">set.seed</span>(<span class="dv">5557</span>)


CP =<span class="st"> </span><span class="kw">replicate</span>(m,<span class="dt">expr=</span>{
 x =<span class="st"> </span><span class="kw">rchisq</span>(n,<span class="dt">df=</span><span class="dv">2</span>)
 d =<span class="st"> </span><span class="kw">qt</span>(.<span class="dv">975</span>,n<span class="op">-</span><span class="dv">1</span>)<span class="op">*</span><span class="kw">sd</span>(x)<span class="op">/</span><span class="kw">sqrt</span>(n)
 <span class="kw">c</span>(<span class="kw">mean</span>(x)<span class="op">-</span>d,<span class="kw">mean</span>(x)<span class="op">+</span>d)
 })
<span class="kw">mean</span>(<span class="dv">2</span><span class="op">&gt;</span><span class="st"> </span>CP[<span class="dv">1</span>,]<span class="op">&amp;</span><span class="st"> </span><span class="dv">2</span><span class="op">&lt;</span><span class="st"> </span>CP[<span class="dv">2</span>,])</code></pre></div>
<pre><code># [1] 0.938</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">UCL =<span class="st"> </span><span class="kw">replicate</span>(m, <span class="dt">expr =</span>{
  x =<span class="st"> </span><span class="kw">rchisq</span>(n,<span class="dt">df=</span><span class="dv">2</span>)
 (n<span class="op">-</span><span class="dv">1</span>)<span class="op">*</span><span class="kw">var</span>(x)<span class="op">/</span><span class="kw">qchisq</span>(.<span class="dv">05</span>,<span class="dt">df=</span>n<span class="op">-</span><span class="dv">1</span>)
})

<span class="kw">mean</span>(UCL<span class="op">&gt;</span><span class="dv">4</span>)</code></pre></div>
<pre><code># [1] 0.801</code></pre>
<p>The coverage probability for t-interval is 0.938 and the coverage probability for variance interval is 0.801. It’s obvious that the CP for t-interval is much closer to 0.95. Therefore, the t-interval is more robust to departures from normality than the interval for variance.</p>
</div>
<div id="section-7" class="section level4">
<h4>6.6</h4>
<p>Estimate the <strong>0.025, 0.05, 0.95, and 0.975 quantiles</strong> of the skewness <span class="math inline">\(\sqrt{b_1}\)</span> under normality by a Monte Carlo experiment. <span class="math display">\[\sqrt(b_1)=\frac{\frac{1}{n}\sum_{i=1}^{n}(X_i-\bar{X})^3}{(\frac{1}{n}\sum_{i=1}^{n}(X_i-\bar{X})^2)^{3/2}}\]</span> Compute the standard error of the estimates from (2.14) <span class="math display">\[Var(\hat{x_q})=\frac{q(1-q)}{nf^2(x)}\]</span> using the normal approximation for the density (with exact variance formula) <span class="math display">\[Var(\sqrt{b_1})=\frac{6(n-2)}{(n+1)(n+3)}\]</span> Compare the estimated quantiles with the quantiles of the large sample approximation. <span class="math display">\[\sqrt{b_1}\approx N(0,\frac{6}{n})\]</span></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">1234</span>)
sk =<span class="st"> </span><span class="cf">function</span>(x) {
 <span class="co">#computes the sample skewness coeff.</span>
 xbar &lt;-<span class="st"> </span><span class="kw">mean</span>(x)
 m3 &lt;-<span class="st"> </span><span class="kw">mean</span>((x <span class="op">-</span><span class="st"> </span>xbar)<span class="op">^</span><span class="dv">3</span>)
 m2 &lt;-<span class="st"> </span><span class="kw">mean</span>((x <span class="op">-</span><span class="st"> </span>xbar)<span class="op">^</span><span class="dv">2</span>)
 <span class="kw">return</span>( m3 <span class="op">/</span><span class="st"> </span>m2<span class="op">^</span><span class="fl">1.5</span> )
}
m=<span class="dv">1000</span>;n=<span class="dv">100</span>
stat =<span class="st"> </span><span class="kw">replicate</span>(m, <span class="dt">expr=</span>{
 x =<span class="st"> </span><span class="kw">rnorm</span>(n)
 y =<span class="st"> </span><span class="kw">sk</span>(x)
})
q =<span class="st"> </span><span class="kw">c</span>(.<span class="dv">025</span>,.<span class="dv">05</span>,.<span class="dv">95</span>,.<span class="dv">975</span>)
x =<span class="st"> </span><span class="kw">quantile</span>(stat,q)

sd_sk =<span class="st"> </span><span class="cf">function</span>(x,q,n){
 sv =<span class="st"> </span><span class="dv">6</span><span class="op">*</span>(n<span class="op">-</span><span class="dv">2</span>)<span class="op">/</span>(n<span class="op">+</span><span class="dv">1</span>)<span class="op">/</span>(n<span class="op">+</span><span class="dv">3</span>)
 var_q=q<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>q)<span class="op">/</span>n<span class="op">/</span><span class="kw">dnorm</span>(x,<span class="dt">mean=</span><span class="dv">0</span>,<span class="dt">sd=</span><span class="kw">sqrt</span>(sv))
 <span class="kw">return</span>(<span class="kw">sqrt</span>(var_q))
}
<span class="kw">print</span>(<span class="st">'The standard error of the estimates:'</span>)</code></pre></div>
<pre><code># [1] &quot;The standard error of the estimates:&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">sd_sk</span>(x,q,n)</code></pre></div>
<pre><code>#       2.5%         5%        95%      97.5% 
# 0.03031220 0.03138412 0.03452726 0.03350760</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">cv =<span class="st"> </span><span class="kw">qnorm</span>(q,<span class="dv">0</span>,<span class="kw">sqrt</span>(<span class="dv">6</span><span class="op">/</span>n))
quat=<span class="kw">rbind</span>(x,cv,x<span class="op">-</span>cv)
<span class="kw">rownames</span>(quat)=<span class="kw">c</span>(<span class="st">'estimated quantiles'</span>,<span class="st">'quat of large sample approx'</span>,<span class="st">'bias (est-app)'</span>)
knitr<span class="op">::</span><span class="kw">kable</span>(quat)</code></pre></div>
<table>
<thead>
<tr class="header">
<th></th>
<th align="right">2.5%</th>
<th align="right">5%</th>
<th align="right">95%</th>
<th align="right">97.5%</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>estimated quantiles</td>
<td align="right">-0.4566391</td>
<td align="right">-0.3754415</td>
<td align="right">0.4031574</td>
<td align="right">0.4808101</td>
</tr>
<tr class="even">
<td>quat of large sample approx</td>
<td align="right">-0.4800912</td>
<td align="right">-0.4029052</td>
<td align="right">0.4029052</td>
<td align="right">0.4800912</td>
</tr>
<tr class="odd">
<td>bias (est-app)</td>
<td align="right">0.0234521</td>
<td align="right">0.0274638</td>
<td align="right">0.0002521</td>
<td align="right">0.0007190</td>
</tr>
</tbody>
</table>
<p>It can be seen that the estimated quantiles are close to the approximate ones. And it should be noticed that the values of quantiles depend on n. Thus it will have different values for quantiles when choosing different n. The scoring criteria should not be based on the absolute-unchanging values of quantiles and it should be compared with the approximate ones to decide whether it’s correct or not.</p>
</div>
</div>
<div id="homework-5-11.1" class="section level3">
<h3>Homework-5 11.1</h3>
<div id="estimate-the-power-of-the-skewness-test-of-normality-against-symmetric-betaalpha-alpha-distributions-and-comment-on-the-results.-are-the-results-different-for-heavy-tailed-symmetric-alternatives-such-as-tnu" class="section level4">
<h4><strong>6.7</strong> Estimate the power of the skewness test of normality against symmetric Beta<span class="math inline">\((\alpha, \alpha)\)</span> distributions and comment on the results. Are the results different for heavy-tailed symmetric alternatives such as t<span class="math inline">\((\nu)\)</span>?</h4>
<p>1.Select a particular value of the parameter <span class="math inline">\(\theta_1\in \Theta\)</span><br />
2.For each replicate,indexed by j=1…m:<br />
(a) Generate the <span class="math inline">\(j^{th}\)</span> n random sample under <span class="math inline">\(\theta=\theta_1\)</span><br />
(b) Compute the test statistics <span class="math inline">\(T_j\)</span><br />
(c) Set <span class="math inline">\(I_j=1\)</span> if <span class="math inline">\(H_0\)</span> is rejected at significance level <span class="math inline">\(\alpha\)</span>, and otherwise set <span class="math inline">\(I_j=0\)</span><br />
3.Compute the proportion of significant test <span class="math inline">\(\hat{\pi}(\theta_1)=\frac{1}{m}\sum_{j=1}^{m}I_j\)</span></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">1234</span>)
sk =<span class="st"> </span><span class="cf">function</span>(x) {
  xbar =<span class="st"> </span><span class="kw">mean</span>(x)
  m3 =<span class="st"> </span><span class="kw">mean</span>((x <span class="op">-</span><span class="st"> </span>xbar)<span class="op">^</span><span class="dv">3</span>)
  m2 =<span class="st"> </span><span class="kw">mean</span>((x <span class="op">-</span><span class="st"> </span>xbar)<span class="op">^</span><span class="dv">2</span>)
  <span class="kw">return</span>( m3 <span class="op">/</span><span class="st"> </span>m2<span class="op">^</span><span class="fl">1.5</span> )
}

pwr_beta =<span class="st"> </span><span class="cf">function</span>(a){
 alpha =<span class="st"> </span>.<span class="dv">1</span>;n =<span class="st"> </span><span class="dv">30</span>;m =<span class="st"> </span><span class="dv">10000</span>;N =<span class="st"> </span><span class="kw">length</span>(a)
 pwr =<span class="st"> </span><span class="kw">numeric</span>(N)
 cv =<span class="st"> </span><span class="kw">qnorm</span>(<span class="dv">1</span><span class="op">-</span>alpha<span class="op">/</span><span class="dv">2</span>, <span class="dv">0</span>, <span class="kw">sqrt</span>(<span class="dv">6</span><span class="op">*</span>(n<span class="op">-</span><span class="dv">2</span>) <span class="op">/</span><span class="st"> </span>((n<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span>(n<span class="op">+</span><span class="dv">3</span>))))
 <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N) { <span class="co">#for each a</span>
  sktests =<span class="st"> </span><span class="kw">numeric</span>(m)
  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) { 
   x =<span class="st"> </span><span class="kw">rbeta</span>(n, a[j], a[j])
   sktests[i] =<span class="st"> </span><span class="kw">as.integer</span>(<span class="kw">abs</span>(<span class="kw">sk</span>(x))<span class="op">&gt;=</span><span class="st"> </span>cv)
  }
  pwr[j] =<span class="st"> </span><span class="kw">mean</span>(sktests)
 }
 se =<span class="st"> </span><span class="kw">sqrt</span>(pwr <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span><span class="op">-</span>pwr) <span class="op">/</span><span class="st"> </span>m) <span class="co">#add standard errors</span>
 <span class="kw">plot</span>(a, pwr, <span class="dt">type =</span> <span class="st">&quot;b&quot;</span>,<span class="dt">xlab =</span> <span class="st">&quot;a&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot;pwr&quot;</span>, <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="fl">0.12</span>),<span class="dt">pch=</span><span class="dv">20</span>,
 <span class="dt">main=</span><span class="kw">paste</span>(<span class="st">'a from'</span>,<span class="kw">min</span>(a),<span class="st">'to'</span>,<span class="kw">max</span>(a)))
 <span class="kw">abline</span>(<span class="dt">h =</span> .<span class="dv">1</span>, <span class="dt">lty =</span> <span class="dv">2</span>)
 <span class="kw">lines</span>(a, pwr<span class="op">+</span>se, <span class="dt">lty =</span> <span class="dv">3</span>)
 <span class="kw">lines</span>(a, pwr<span class="op">-</span>se, <span class="dt">lty =</span> <span class="dv">3</span>)
 <span class="kw">text</span>(a[<span class="kw">ceiling</span>(<span class="fl">0.3</span><span class="op">*</span>N)],<span class="fl">0.105</span>,<span class="kw">paste</span>(<span class="st">&quot;alpha =&quot;</span>,alpha))
}

a1 =<span class="st"> </span><span class="kw">c</span>(<span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="fl">0.1</span>))
a2 =<span class="st"> </span><span class="kw">c</span>(<span class="kw">seq</span>(<span class="dv">1</span>,<span class="dv">20</span>,<span class="dv">2</span>),<span class="kw">seq</span>(<span class="dv">20</span>,<span class="dv">100</span>,<span class="dv">5</span>))
<span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))
<span class="kw">pwr_beta</span>(a1);<span class="kw">pwr_beta</span>(a2)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --></p>
<p>The power of the skewness test of normality against symmetric Beta(<span class="math inline">\(\alpha,\alpha\)</span>) distribution is under 0.1. The behaviors for a&gt;1 and a&lt;1 are different. The empirical power is more and more far away from 0.1 With the increase of a when a&lt;1. The empirical power for a&gt;1 increases to 0.1 when a gets larger. Generally, the empirical powers for the two cases are smaller than 0.1 (confidence level).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">pwr_t =<span class="st"> </span><span class="cf">function</span>(v){
 alpha =<span class="st"> </span>.<span class="dv">1</span>;n =<span class="st"> </span><span class="dv">30</span>;m =<span class="st"> </span><span class="dv">2500</span>;N =<span class="st"> </span><span class="kw">length</span>(v)
 pwr =<span class="st"> </span><span class="kw">numeric</span>(N)
 cv =<span class="st"> </span><span class="kw">qnorm</span>(<span class="dv">1</span><span class="op">-</span>alpha<span class="op">/</span><span class="dv">2</span>, <span class="dv">0</span>, <span class="kw">sqrt</span>(<span class="dv">6</span><span class="op">*</span>(n<span class="op">-</span><span class="dv">2</span>) <span class="op">/</span><span class="st"> </span>((n<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span>(n<span class="op">+</span><span class="dv">3</span>))))
 <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N) { <span class="co">#for each v</span>
  sktests =<span class="st"> </span><span class="kw">numeric</span>(m)
  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) { 
   x =<span class="st"> </span><span class="kw">rt</span>(n,v[j])
   sktests[i] =<span class="st"> </span><span class="kw">as.integer</span>(<span class="kw">abs</span>(<span class="kw">sk</span>(x))<span class="op">&gt;=</span><span class="st"> </span>cv)
  }
  pwr[j] =<span class="st"> </span><span class="kw">mean</span>(sktests)
 }
 se =<span class="st"> </span><span class="kw">sqrt</span>(pwr<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>pwr) <span class="op">/</span><span class="st"> </span>m) <span class="co">#add standard errors</span>
 <span class="kw">plot</span>(v, pwr, <span class="dt">type =</span> <span class="st">&quot;b&quot;</span>,<span class="dt">xlab =</span> <span class="st">&quot;v&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot;pwr&quot;</span>,<span class="dt">pch=</span><span class="dv">20</span>,<span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),
 <span class="dt">main=</span><span class="st">&quot;Power of skewness test against t(v)&quot;</span>)
 <span class="kw">abline</span>(<span class="dt">h =</span> .<span class="dv">1</span>, <span class="dt">lty =</span> <span class="dv">2</span>)
 <span class="kw">lines</span>(v, pwr<span class="op">+</span>se, <span class="dt">lty =</span> <span class="dv">3</span>)
 <span class="kw">lines</span>(v, pwr<span class="op">-</span>se, <span class="dt">lty =</span> <span class="dv">3</span>)
 <span class="kw">text</span>(v[<span class="kw">ceiling</span>(<span class="fl">0.8</span><span class="op">*</span>N)],<span class="fl">0.8</span>,<span class="kw">paste</span>(<span class="st">&quot;alpha =&quot;</span>,alpha))
}
v=<span class="kw">seq</span>(<span class="dv">1</span>,<span class="dv">20</span>);<span class="kw">pwr_t</span>(v)</code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAyVBMVEUAAAAAADoAAGYAOjoAOmYAOpAAZmYAZpAAZrY6AAA6ADo6AGY6OgA6Ojo6OmY6OpA6ZmY6ZpA6ZrY6kLY6kNtmAABmADpmOgBmOjpmZgBmZmZmkJBmkLZmkNtmtttmtv+QOgCQZgCQZjqQkGaQkLaQtpCQttuQtv+Q27aQ29uQ2/+2ZgC2Zjq2ZpC2kDq2kGa225C229u22/+2/7a2/9u2///bkDrbkGbbtmbbtpDb27bb29vb////tmb/25D/27b//7b//9v////LqtZ3AAAACXBIWXMAAA7DAAAOwwHHb6hkAAALVElEQVR4nO2dCXfbxhWFYUVKScdN2pSM0y1i06aL6SxVazZ1RUrk//9RnRV4AwK4AxBDDKl7z7EJAYM7wIc3D4OFw+JAdaqYegNyFwEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBFYdNYfX5w+lu+/fzoviyPndd3Hw43buhtu/bbbuW1YuuirvH1qUVoOLVu37b16Ct9lnU5yYC9PS23bZrWV2dgJ4EoC6Okdo0Uk4EqMt2tCrXGpDxelranfvv10XxyR8e9aI7839xbyLjXrUfFWVfaoiKw3dvixvfJsUqIhD/80ZN//rBb+3z0qxQmtTtlec/1LJbs3ZVlbCRkwdXmTJuKuuX2c17qxNI6Xv7ztIrZ9sICuqXRh6QO/qbMpi2+m+1W7rJaEs9qXT7wRfyAVetIgG5udpbr622Qi+oTOr2PpDDUtJGTApAjWUloG3lqzZCT73Ri6rZHlBVLjDygD4u9edu7gov9OS9/q+YaYuZ3osH/ffCGNw9HP5nN1SsIpqY2u7Z4+Fnv///XplQESZ1e2Vw++BsqlLCRjo6Qo7+cVnRxJT5Lx7ddisos8f9urAHzM8uAfn6Q6MwBzljd8zNZqtJvTNqrYUJDFVgY/dWbqf9qACpVW7/WZX4rd0vYVKzd55qciZLCRvpWFXcXLaWgz7++EYfCDf3eekWutklIF9/aBScxXxCNzu6UdPr4tPlq3eu+rKYzMW1VfwCG80mM4mWF5pIe7eqPniylLCRjhWE5rIS0P5bW8CTcAvrs0X9oZEHZHKSWX5wSVllib8vi29WxUIn1K3gKAEFq4gFT29t6b85QGbbpEloLzdQlhI2YrIC1FI2aGLF7V8+Lm1kzvyKYvYRoNCoTNJH4aAK/2quj++nS58znCIiSCP685vC5+67H3wElyahfS2CqhZc2QSTIoKaylaAbPZ5XtYi6Gi2BBQYBYCChGKOvA0di2vWBKglBzl6f7KnAnOyUdVJk9BebmBQqrKpT/oc1FS2ArT1R2YR5CAxuwmQMAoByVOSCV+zua7L8uob3VsqzRpWqRaodX/zqGPVH067RcKkZi83sColbKSjOEyNZcOzxd3j08okaXEWE7OPAIVGISDRqbEp9d40Yk3VdTiqo92wiljwvkwNLimuXAj5uTV7CUiUEjZi0h+Dqh9UK2CXmUBYuSQ1C/pBYvZxBAVGNUC2W/zHg/N23SbTzJ++VXtkOrK1llStIhf8rFvx52VP2kV5ZVKzD0JclKps5KRZ/73pujSWdctMMXW6uv2r3Us9+4uH8ixmZzc0MWH0Em93rPtcdb4oQGtzL8Z0BqP1ogD5TlOfGzsvCtDh6eu5vCEQo5cFaIAICIiAgAgIiICACAiIgIAICIiAgAgIiICACAiIgIAICIiAgAgIiICACAiIgIAICIiAgAgIiICACAiIgIAICIiAgEYGVFyMpgI0rl06ERAQAQGdGVD/pj21GEFABAREQEAEBERAQAQEREBABAREQEAEBJQI0LooZvtVIb/0fIrdhEoDaGO+Pmi+8XY0QIewu4RLsiSA9iv95XzzVZlNyzeutN1FXLQmAfS81ONsmO8nblvGDnnZgDKJIHOcGqbbtA2/ILb7TB/bxDnIoGq1SxxAPQHpI7qVAyHcpAMUfxbLJ4LssVz7L2GqcEoJKNouCaC1PTIKyu71d/PCDp3w+7kfV6b5sO3m5jvV5Vg5i+3VAtJRsDFjQNybASm26t/zUg+Iof75hVpuwBP71+61/hAnlfMA2nScxU6w7dLzV+9sPBhAZkycu0fTIVMzy4VHsulHJKFJIuj4pn2aJGTGtzCANAq11yYHuUS0bWxjeQBqsBuf0KYobn5yEfTa7XUJyC880kRNDNqNf6Y3UbNrAVQutCVlDgqS9CExIHOKV2odgy9hBJkd2xYiB611DrKAyoUNmxyc5tMC2vgB1rbHo0nW7UYPIRs8Zgw2BcgMYXV/kBHkhjOrq9ZRTAlI9J+7LjUGOEdpo1vN2jSr3dx1f2QOMgvb1tNbb6MoISDRbe26WB3g3FeNJ/ReusYIEsoUkApWt10ROSgpoVwB+bGz2gcoKlr/yEyT94PGtx5XOQDKmlAWgHImREBAmQDK9+Z9FoByfrxBQEAEBNQfUOuTnBPqzZfPAEAxj+AG1JsroQFNrO0C/cR6MyU0JIIKcLewy6X1TftM+eSRpFNUMJbyAZQpoUFNrMcgwn3qzZLQgAiSo6mPWW+WfIY3Mfd2yJj1ZkloGCAdRKNHUJ6EBgDSzyNP7go115shoSFJOk1H8WB7Sadbj6shTazfYPg96s3xonVgkt60v1wn1PHQ5doBdbe08mqk/YLkmgGt8bWYe17YN4JyvO0xqCeNz/DPS/3IsDegXlt0HiW7FtMvUAwClBmhIYBMioG/erMpFi80gtx3DGA7280/eZERtF/ZvV7DGNqv2vsCnfXmhGhAkv7Khs5pd167683obDY8gtpejQqFXiRvXphRf2hIDnI/FDfk4Ub7PemjUgPcU+iEm/YD79tH1HvZgM5Rbz58UgHq8SL5KPWlUxpAfV4kH6nKVEoCqN9rwOPUmUpJAPV7kbyjygxyUd4RlMHZLFUO6vMieXudVwuo54vkrXUaQNMiyrMfVJYyATQpobwBlUWna2oXAMiezaYidAmAJs3WFwRoGkSXAYg5KGqVogJ1PmAXBOhQNbWyyaUHdYGAGj4T6gIBiQiqkncyUJcFqJ6DZFMLQY0G7MyA4m7a9/KrfA8VqLKKsqahVV5YBLXa1cA0gQoJxQK7EkBhm2v/DAuOuqGZAyp9m5JUF7D6ivXQujZAR/WE+90I6nAoJ467WNcO6Khe2z1w++/vE3gq9SzWZ0OvBFCtBdUiqt7F6rOh1wKopjCi3JxqAQG1n+5faA7qrUSA9ivblNufzddzYbafSQCN82w+CyUBNNaT1RyUBNBIz+azECMIKFUOGuXZfA5KdBYb59l8DmI/CIiAgFIDGvQieU46cwQVpUaxO4PYxIAICGiyi9VedhOKF6tAk11qXIxSAIq4WB291vF3pGeQjxxBo9d6UYAiLlZHr/WyAOGL1dFrvTBAY4mARquVgMYqSUBnLzio+EgioOsRAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERDQ+QHZ27YRI1fvPjNPTrZwGHlbEPnuV2rxIs5R6PyA7A9ZY7mBm+u/RNxaEPjuV8pkowFiR6nzA4p8pKYOsy549FvWbQWRb/mr4dgx0PkBbaI2bVsszB4f/Rp6W8E4XxU50DHU+QGtf+lzAZAFZH9ZvnN37NIo3/XNhxhHobMDsmN2ryMI2d+QN8miO2WYglG++oFnjKPQRKf5mAPYD1CM79bn6PwBxfyadc8mhn3tA/Pcm5hVzLk+LkkfQkAdvhv5kwX5Jmm7fdFNLOakLEh2+Po3L7I/zZtNi07SMd06dxbr9t3N/aLcO4rmBzxiBq120bCBFwauYLfvxr6Xoq2woxAvVoEICIiAgAgIiICACAiIgIAICIiAgAgIiICACAiIgIAICIiAgAgIiICACAiIgIAICIiAgAgIiICACAiIgIAICIiAgAgIiICACAgoc0Dutaj4t1VGV+aA9ivzWtSpo82coMwBmXcJn5enjVZ0knIHpIcFm7KFZQ9Iv3o4ZQvLH9D25l/LmDcaUyl7QM/L35024t6Jyh7QYR3z5bt0yh/QNuqd4WTKH9DEIiAgAgIiICACAiIgIAICIiAgAgIiICACAiIgIAICIiAgAgIiICACAiIgIAICIiAgAgIiICACAiIgoP8DQ6v/PxclSHwAAAAASUVORK5CYII=" /><!-- --></p>
<p>The results are different for heavy-tailed symmetric alternatives. When for t distribution, the empirical power is always bigger than 0.1 (the confidence level we set) and it decreases to 0.1 with the increase of v. When for Beta distribution, the empirical power increases monotonously to 0.1. This is because Beta(<span class="math inline">\(\alpha,\alpha\)</span>) is a symmetric distribution with zero skewness like normal distribution. Thus the power for Beta distribution is small and it is hard to detect the non-normality. But in heavy-tailed t distribution case, the power is large. When v grows bigger, the tail becomes lighter, and the power decrease. So, we can say that the power of skewness test is heavily influenced by heavy-tailed.</p>
</div>
<div id="a-use-monte-carlo-simulation-to-investigate-whether-the-empirical-type-i-error-rate-of-the-t-test-is-approximately-equal-to-the-nominal-significance-level-alpha-when-the-sampled-population-is-non-normal." class="section level4">
<h4><strong>6.A</strong> Use Monte Carlo simulation to investigate whether the empirical Type I error rate of the t-test is approximately equal to the nominal significance level <span class="math inline">\(\alpha\)</span>, when the sampled population is non-normal.</h4>
<p><span class="math display">\[H_0: \mu=\mu_0\qquad vs\qquad H_a: \mu\ne\mu_0\]</span> <span class="math display">\[E(\chi^2(1))=E(U(0,2))=E(Exp(1))=1=\mu_0\]</span> <span class="math display">\[T=\frac{\sqrt{n}(\bar{X}-\mu_0)}{S}\sim t_{n-1}\qquad p\ value = 2P(T&gt;|T^{(o)}|)\]</span> <span class="math display">\[Type-I\ error: P_{H_0}(p\ value\le \alpha)\]</span></p>
</div>
<div id="chi21" class="section level4">
<h4>(1)<span class="math inline">\(\chi^2(1)\)</span></h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">m =<span class="st"> </span><span class="fl">1e4</span>; n =<span class="st"> </span><span class="dv">10</span>; mu0 =<span class="st"> </span><span class="dv">1</span> 
mu.hat =<span class="st"> </span>mu.se =<span class="st"> </span>p.val1 =<span class="st"> </span><span class="kw">numeric</span>(m)
 <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){
 x =<span class="st"> </span><span class="kw">rchisq</span>(n,<span class="dv">1</span>)
 mu.hat[i] &lt;-<span class="st"> </span><span class="kw">mean</span>(x);mu.se[i] &lt;-<span class="st"> </span><span class="kw">sd</span>(x)
 p.val1[i] &lt;-<span class="st"> </span><span class="kw">t.test</span>(x,<span class="dt">mu=</span><span class="dv">1</span>)<span class="op">$</span>p.value
}
T=<span class="kw">sqrt</span>(n)<span class="op">*</span>(mu.hat<span class="op">-</span>mu0)<span class="op">/</span>mu.se
p.val2=<span class="dv">2</span><span class="op">*</span><span class="kw">pt</span>(<span class="kw">abs</span>(T),(n<span class="op">-</span><span class="dv">1</span>),<span class="dt">lower.tail=</span><span class="ot">FALSE</span>)
<span class="kw">print</span>(<span class="kw">c</span>(<span class="kw">mean</span>(p.val1<span class="op">&lt;=</span><span class="fl">0.05</span>),<span class="kw">mean</span>(p.val2<span class="op">&lt;=</span><span class="fl">0.05</span>)))</code></pre></div>
<pre><code># [1] 0.1361 0.1361</code></pre>
<p>When samples come from <span class="math inline">\(\chi^2\)</span> distribution, the empirical t1e is far away from nominal significance level 0.05. Thus choosing p value <span class="math inline">\(\le 0.05\)</span> under this circumstance can’t ensure the type-I error under nominal significance level.</p>
</div>
<div id="u02" class="section level4">
<h4>(2)<span class="math inline">\(U(0,2)\)</span></h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){
 x=<span class="kw">runif</span>(n,<span class="dv">0</span>,<span class="dv">2</span>)
 mu.hat[i] &lt;-<span class="st"> </span><span class="kw">mean</span>(x);mu.se[i] &lt;-<span class="st"> </span><span class="kw">sd</span>(x)
 p.val1[i] &lt;-<span class="st"> </span><span class="kw">t.test</span>(x,<span class="dt">mu=</span><span class="dv">1</span>)<span class="op">$</span>p.value
}
T=<span class="kw">sqrt</span>(n)<span class="op">*</span>(mu.hat<span class="op">-</span>mu0)<span class="op">/</span>mu.se
p.val2=<span class="dv">2</span><span class="op">*</span><span class="kw">pt</span>(<span class="kw">abs</span>(T),(n<span class="op">-</span><span class="dv">1</span>),<span class="dt">lower.tail=</span><span class="ot">FALSE</span>)
<span class="kw">print</span>(<span class="kw">c</span>(<span class="kw">mean</span>(p.val1<span class="op">&lt;=</span><span class="fl">0.05</span>),<span class="kw">mean</span>(p.val2<span class="op">&lt;=</span><span class="fl">0.05</span>)))</code></pre></div>
<pre><code># [1] 0.0544 0.0544</code></pre>
<p>When samples come from uniform distribution, the empirical t1e is close to nominal significance level 0.05. Therefore, under this case, choosing p value <span class="math inline">\(\le 0.05\)</span> can efficiently control the type-I error.</p>
</div>
<div id="exp1" class="section level4">
<h4>(3)Exp(1)</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){
 x=<span class="kw">rexp</span>(n,<span class="dv">1</span>)
 mu.hat[i] &lt;-<span class="st"> </span><span class="kw">mean</span>(x);mu.se[i] &lt;-<span class="st"> </span><span class="kw">sd</span>(x)
 p.val1[i] &lt;-<span class="st"> </span><span class="kw">t.test</span>(x,<span class="dt">mu=</span><span class="dv">1</span>)<span class="op">$</span>p.value
}
T=<span class="kw">sqrt</span>(n)<span class="op">*</span>(mu.hat<span class="op">-</span>mu0)<span class="op">/</span>mu.se
p.val2=<span class="dv">2</span><span class="op">*</span><span class="kw">pt</span>(<span class="kw">abs</span>(T),(n<span class="op">-</span><span class="dv">1</span>),<span class="dt">lower.tail=</span><span class="ot">FALSE</span>)
<span class="kw">print</span>(<span class="kw">c</span>(<span class="kw">mean</span>(p.val1<span class="op">&lt;=</span><span class="fl">0.05</span>),<span class="kw">mean</span>(p.val2<span class="op">&lt;=</span><span class="fl">0.05</span>)))</code></pre></div>
<pre><code># [1] 0.0975 0.0975</code></pre>
<p>When samples come from exponential distribution, the empirical t1e is far from nominal significance level 0.05, too, but it is not that worse compared with <span class="math inline">\(\chi^2\)</span> distribution. Choosing p value <span class="math inline">\(\le 0.05\)</span> can’t ensure type-I error under nominal significance level.</p>
</div>
<div id="if-we-obtain-the-powers-for-two-methods-under-a-particular-simulation-setting-with-10000-experiments-say-0.651-for-one-method-and-0.676-for-another-method.-can-we-say-the-powers-are-different-at-0.05-level" class="section level4">
<h4><strong>3.</strong> If we obtain the powers for two methods under a particular simulation setting with 10,000 experiments: say, 0.651 for one method and 0.676 for another method. Can we say the powers are different at 0.05 level?</h4>
<p>We should use the McNemar test.</p>
</div>
</div>
<div id="homework-6-11.8" class="section level3">
<h3>Homework-6 11.8</h3>
<div id="use-a-panel-display-to-display-the-scatter-plots-for-each-pair-of-test-scores.-compare-the-plot-with-the-sample-correlation-matrix.-obtain-bootstrap-estimates-of-the-standard-errors-for-each-of-the-following-estimates-rho_12rhomecvec-rho_34rhoalgana-rho_35rhoalgsta-rho_45rhoanasta-." class="section level4">
<h4>7.6 Use a panel display to display the scatter plots for each pair of test scores. Compare the plot with the sample correlation matrix. Obtain bootstrap estimates of the standard errors for each of the following estimates: <span class="math inline">\(\rho_{12}=\rho(mec,vec), \rho_{34}=\rho(alg,ana), \rho_{35}=\rho(alg,sta), \rho_{45}=\rho(ana,sta)\)</span> .</h4>
<p>The standard error of <span class="math inline">\(\rho\)</span> can be estimated with the <strong>sample standard error</strong> of <span class="math inline">\(\rho^*\)</span>, I carried out 2000 times of bootstrap, computed the correlation coefficient and estimated the standard error of the bootstrap correlation coefficients.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">8888</span>)
<span class="kw">data</span>(scor, <span class="dt">package =</span> <span class="st">&quot;bootstrap&quot;</span>)
scor=<span class="kw">data.matrix</span>(scor)
<span class="kw">pairs</span>(scor,<span class="dt">main=</span><span class="st">'Scatter plots for each pair of test scores'</span>,<span class="dt">pch=</span><span class="dv">20</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">cor_mat =<span class="st"> </span><span class="cf">function</span>(x){
 n=<span class="kw">dim</span>(x)[<span class="dv">1</span>]
 one=<span class="kw">rep</span>(<span class="dv">1</span>,n);<span class="kw">dim</span>(one)=<span class="kw">c</span>(n,<span class="dv">1</span>);ONE=<span class="kw">diag</span>(n)
 Po=one<span class="op">%*%</span><span class="kw">t</span>(one)<span class="op">/</span>n
 S=<span class="kw">t</span>(x)<span class="op">%*%</span>(ONE<span class="op">-</span>Po)<span class="op">%*%</span>x<span class="op">/</span>(n<span class="op">-</span><span class="dv">1</span>)    
 D=<span class="kw">c</span>();<span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">dim</span>(x)[<span class="dv">2</span>]) {D=<span class="kw">c</span>(D,S[i,i])};D=<span class="kw">diag</span>(D)
 R=<span class="kw">sqrt</span>(<span class="kw">solve</span>(D))<span class="op">%*%</span>S<span class="op">%*%</span><span class="kw">sqrt</span>(<span class="kw">solve</span>(D))
 <span class="kw">colnames</span>(R)=<span class="kw">rownames</span>(R)=<span class="kw">colnames</span>(x)  
 <span class="kw">return</span>(<span class="dt">R=</span><span class="kw">round</span>(R,<span class="dv">4</span>))
}
<span class="kw">cor_mat</span>(scor)</code></pre></div>
<pre><code>#        mec    vec    alg    ana    sta
# mec 1.0000 0.5534 0.5468 0.4094 0.3891
# vec 0.5534 1.0000 0.6096 0.4851 0.4364
# alg 0.5468 0.6096 1.0000 0.7108 0.6647
# ana 0.4094 0.4851 0.7108 1.0000 0.6072
# sta 0.3891 0.4364 0.6647 0.6072 1.0000</code></pre>
<p>It can be seen from the scatter plot that there is a positive correlation between each two variables. The only difference is that some of the positive correlations are a little bit weak, e.g. mec v.s sta, mec v.s ana. We can clearly see that all the values in sample correlation matrix are above zero, thus the positive correlation is true. And the values for mec v.s sta is little smaller than other pairs. Therefore, the scatter plots are correspond with the sample correlation matrix.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">rho_<span class="dv">12</span> =<span class="st"> </span><span class="cf">function</span>(x,i) <span class="kw">cor</span>(x[i,<span class="dv">1</span>],x[i,<span class="dv">2</span>])
rho_<span class="dv">34</span> =<span class="st"> </span><span class="cf">function</span>(x,i) <span class="kw">cor</span>(x[i,<span class="dv">3</span>],x[i,<span class="dv">4</span>])
rho_<span class="dv">35</span> =<span class="st"> </span><span class="cf">function</span>(x,i) <span class="kw">cor</span>(x[i,<span class="dv">3</span>],x[i,<span class="dv">5</span>])
rho_<span class="dv">45</span> =<span class="st"> </span><span class="cf">function</span>(x,i) <span class="kw">cor</span>(x[i,<span class="dv">4</span>],x[i,<span class="dv">5</span>])

r12_b =<span class="st"> </span>boot<span class="op">::</span><span class="kw">boot</span>(<span class="dt">data=</span>scor,<span class="dt">statistic=</span>rho_<span class="dv">12</span>,<span class="dt">R=</span><span class="dv">2000</span>)
r34_b =<span class="st"> </span>boot<span class="op">::</span><span class="kw">boot</span>(<span class="dt">data=</span>scor,<span class="dt">statistic=</span>rho_<span class="dv">34</span>,<span class="dt">R=</span><span class="dv">2000</span>)
r35_b =<span class="st"> </span>boot<span class="op">::</span><span class="kw">boot</span>(<span class="dt">data=</span>scor,<span class="dt">statistic=</span>rho_<span class="dv">35</span>,<span class="dt">R=</span><span class="dv">2000</span>)
r45_b =<span class="st"> </span>boot<span class="op">::</span><span class="kw">boot</span>(<span class="dt">data=</span>scor,<span class="dt">statistic=</span>rho_<span class="dv">45</span>,<span class="dt">R=</span><span class="dv">2000</span>)

OUT=<span class="kw">matrix</span>(<span class="kw">c</span>(<span class="kw">sd</span>(r12_b<span class="op">$</span>t),<span class="kw">sd</span>(r34_b<span class="op">$</span>t),<span class="kw">sd</span>(r35_b<span class="op">$</span>t),<span class="kw">sd</span>(r45_b<span class="op">$</span>t)),<span class="dt">nrow=</span><span class="dv">1</span>,<span class="dt">byrow=</span>T)
OUT=<span class="kw">round</span>(OUT,<span class="dv">4</span>)
<span class="kw">colnames</span>(OUT)=<span class="kw">c</span>(<span class="st">&quot;p_12&quot;</span>,<span class="st">&quot;p_34&quot;</span>,<span class="st">&quot;p_35&quot;</span>,<span class="st">&quot;p_45&quot;</span>);<span class="kw">rownames</span>(OUT)=<span class="st">&quot;standard error&quot;</span>
knitr<span class="op">::</span><span class="kw">kable</span>(OUT)</code></pre></div>
<table>
<thead>
<tr class="header">
<th></th>
<th align="right">p_12</th>
<th align="right">p_34</th>
<th align="right">p_35</th>
<th align="right">p_45</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>standard error</td>
<td align="right">0.0764</td>
<td align="right">0.0504</td>
<td align="right">0.0604</td>
<td align="right">0.0677</td>
</tr>
</tbody>
</table>
<p>The standard error estimation is showed above.</p>
</div>
<div id="b-repeat-project-7.a-for-the-sample-skewness-statistic.-compare-the-coverage-rates-for-normal-populations-skewness-0-and-chi25-distributions-skewness-sqrtfrac85." class="section level4">
<h4>7.B Repeat Project 7.A for the sample skewness statistic. Compare the coverage rates for normal populations (skewness 0) and <span class="math inline">\(\chi^2(5)\)</span> distributions (skewness <span class="math inline">\(\sqrt{\frac{8}{5}}\)</span>).</h4>
<p><span class="math display">\[Empirical\ coverage\ rates:\ P(CI[1]&lt;=sk&lt;=CI[2])\]</span> <span class="math display">\[Proportion\ miss\ on\ the\ left:\ P(sk&lt;CI[1])\]</span> <span class="math display">\[Proportion\ miss\ on\ the\ right:\ P(sk&gt;CI[2])\]</span></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">SK=<span class="dv">0</span>
boot_sk =<span class="st"> </span><span class="cf">function</span>(x,i) {
  xbar =<span class="st"> </span><span class="kw">mean</span>(x[i])
  m3 =<span class="st"> </span><span class="kw">mean</span>((x[i] <span class="op">-</span><span class="st"> </span>xbar)<span class="op">^</span><span class="dv">3</span>)
  m2 =<span class="st"> </span><span class="kw">mean</span>((x[i] <span class="op">-</span><span class="st"> </span>xbar)<span class="op">^</span><span class="dv">2</span>)
  <span class="kw">return</span>( m3 <span class="op">/</span><span class="st"> </span>m2<span class="op">^</span><span class="fl">1.5</span> )
}
n=<span class="dv">10</span>;m=<span class="dv">1000</span>;
CI.n=CI.b=CI.p=<span class="kw">matrix</span>(<span class="dv">0</span>,m,<span class="dv">2</span>)
<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){
 x=<span class="kw">rnorm</span>(n)
 b =<span class="st"> </span>boot<span class="op">::</span><span class="kw">boot</span>(<span class="dt">data=</span>x,<span class="dt">statistic=</span>boot_sk, <span class="dt">R =</span> <span class="dv">1000</span>)
 CI =<span class="st"> </span>boot<span class="op">::</span><span class="kw">boot.ci</span>(b,<span class="dt">type=</span><span class="kw">c</span>(<span class="st">&quot;norm&quot;</span>,<span class="st">&quot;basic&quot;</span>,<span class="st">&quot;perc&quot;</span>))
 CI.n[i,]=CI<span class="op">$</span>norm[<span class="dv">2</span><span class="op">:</span><span class="dv">3</span>]
 CI.b[i,]=CI<span class="op">$</span>basic[<span class="dv">4</span><span class="op">:</span><span class="dv">5</span>]
 CI.p[i,]=CI<span class="op">$</span>percent[<span class="dv">4</span><span class="op">:</span><span class="dv">5</span>]
}
out=out2=out3=<span class="kw">matrix</span>(<span class="dv">0</span>,<span class="dt">nrow=</span><span class="dv">2</span>,<span class="dt">ncol=</span><span class="dv">3</span>)
out[<span class="dv">1</span>,]=<span class="kw">c</span>(<span class="kw">mean</span>(CI.n[,<span class="dv">1</span>]<span class="op">&lt;=</span>SK <span class="op">&amp;</span><span class="st"> </span>CI.n[,<span class="dv">2</span>]<span class="op">&gt;=</span>SK),<span class="kw">mean</span>(CI.b[,<span class="dv">1</span>]<span class="op">&lt;=</span>SK <span class="op">&amp;</span><span class="st"> </span>CI.b[,<span class="dv">2</span>]<span class="op">&gt;=</span>SK),
<span class="kw">mean</span>(CI.p[,<span class="dv">1</span>]<span class="op">&lt;=</span>SK <span class="op">&amp;</span><span class="st"> </span>CI.p[,<span class="dv">2</span>]<span class="op">&gt;=</span>SK))

out2[<span class="dv">1</span>,]=<span class="kw">c</span>(<span class="kw">mean</span>(CI.n[,<span class="dv">1</span>]<span class="op">&gt;</span>SK),<span class="kw">mean</span>(CI.b[,<span class="dv">1</span>]<span class="op">&gt;</span>SK),<span class="kw">mean</span>(CI.p[,<span class="dv">1</span>]<span class="op">&gt;</span>SK)) 
<span class="co">#miss on the left</span>

out3[<span class="dv">1</span>,]=<span class="kw">c</span>(<span class="kw">mean</span>(CI.n[,<span class="dv">2</span>]<span class="op">&lt;</span>SK),<span class="kw">mean</span>(CI.b[,<span class="dv">2</span>]<span class="op">&lt;</span>SK),<span class="kw">mean</span>(CI.p[,<span class="dv">2</span>]<span class="op">&lt;</span>SK)) 
<span class="co">#miss on the right</span></code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sk=<span class="kw">sqrt</span>(<span class="dv">8</span><span class="op">/</span><span class="dv">5</span>)
Ci.n=Ci.b=Ci.p=<span class="kw">matrix</span>(<span class="dv">0</span>,m,<span class="dv">2</span>)
<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){
 x=<span class="kw">rchisq</span>(n,<span class="dv">5</span>)
 b =<span class="st"> </span>boot<span class="op">::</span><span class="kw">boot</span>(<span class="dt">data=</span>x,<span class="dt">statistic=</span>boot_sk, <span class="dt">R =</span> <span class="dv">1000</span>)
 Ci =<span class="st"> </span>boot<span class="op">::</span><span class="kw">boot.ci</span>(b,<span class="dt">type=</span><span class="kw">c</span>(<span class="st">&quot;norm&quot;</span>,<span class="st">&quot;basic&quot;</span>,<span class="st">&quot;perc&quot;</span>))
 Ci.n[i,]=Ci<span class="op">$</span>norm[<span class="dv">2</span><span class="op">:</span><span class="dv">3</span>]
 Ci.b[i,]=Ci<span class="op">$</span>basic[<span class="dv">4</span><span class="op">:</span><span class="dv">5</span>]
 Ci.p[i,]=Ci<span class="op">$</span>percent[<span class="dv">4</span><span class="op">:</span><span class="dv">5</span>]
}
out[<span class="dv">2</span>,]=<span class="kw">c</span>(<span class="kw">mean</span>(Ci.n[,<span class="dv">1</span>]<span class="op">&lt;=</span>sk <span class="op">&amp;</span><span class="st"> </span>Ci.n[,<span class="dv">2</span>]<span class="op">&gt;=</span>sk),<span class="kw">mean</span>(Ci.b[,<span class="dv">1</span>]<span class="op">&lt;=</span>sk <span class="op">&amp;</span><span class="st"> </span>Ci.b[,<span class="dv">2</span>]<span class="op">&gt;=</span>sk),
<span class="kw">mean</span>(Ci.p[,<span class="dv">1</span>]<span class="op">&lt;=</span>sk <span class="op">&amp;</span><span class="st"> </span>Ci.p[,<span class="dv">2</span>]<span class="op">&gt;=</span>sk))

out2[<span class="dv">2</span>,]=<span class="kw">c</span>(<span class="kw">mean</span>(Ci.n[,<span class="dv">1</span>]<span class="op">&gt;</span>sk),<span class="kw">mean</span>(Ci.b[,<span class="dv">1</span>]<span class="op">&gt;</span>sk),<span class="kw">mean</span>(Ci.p[,<span class="dv">1</span>]<span class="op">&gt;</span>sk))
<span class="co">#miss on the left</span>

out3[<span class="dv">2</span>,]=<span class="kw">c</span>(<span class="kw">mean</span>(Ci.n[,<span class="dv">2</span>]<span class="op">&lt;</span>sk),<span class="kw">mean</span>(Ci.b[,<span class="dv">2</span>]<span class="op">&lt;</span>sk),<span class="kw">mean</span>(Ci.p[,<span class="dv">2</span>]<span class="op">&lt;</span>sk))
<span class="co">#miss on the right</span>

<span class="kw">rownames</span>(out)=<span class="kw">rownames</span>(out2)=<span class="kw">rownames</span>(out3)=<span class="kw">c</span>(<span class="st">&quot;N(0,1)&quot;</span>,<span class="st">&quot;X^2(5)&quot;</span>)
<span class="kw">colnames</span>(out)=<span class="kw">colnames</span>(out2)=<span class="kw">colnames</span>(out3)=<span class="kw">c</span>(<span class="st">&quot;norm&quot;</span>,<span class="st">&quot;basic&quot;</span>,<span class="st">&quot;perc&quot;</span>)
<span class="kw">print</span>(<span class="st">&quot;Empirical Coverage Rates&quot;</span>);out</code></pre></div>
<pre><code># [1] &quot;Empirical Coverage Rates&quot;</code></pre>
<pre><code>#         norm basic  perc
# N(0,1) 0.914 0.903 0.999
# X^2(5) 0.755 0.722 0.737</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">print</span>(<span class="st">&quot;The proportion miss on the left&quot;</span>);out2</code></pre></div>
<pre><code># [1] &quot;The proportion miss on the left&quot;</code></pre>
<pre><code>#         norm basic perc
# N(0,1) 0.035 0.039    0
# X^2(5) 0.006 0.039    0</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">print</span>(<span class="st">&quot;The proportion miss on the right&quot;</span>);out3</code></pre></div>
<pre><code># [1] &quot;The proportion miss on the right&quot;</code></pre>
<pre><code>#         norm basic  perc
# N(0,1) 0.051 0.058 0.001
# X^2(5) 0.239 0.239 0.263</code></pre>
<p>Compared to <span class="math inline">\(\chi^2\)</span> distribution, normal distribution has coverage probability more close to nominal confidence level 0.95.The proportion miss on the left is close to the proportion miss on the right for normal distribution, while for <span class="math inline">\(\chi\)</span> distribution, the proportion miss on the right is larger than the proprtion miss on the left which also indicates the asymmetry.</p>
</div>
</div>
<div id="homework-7-11.15" class="section level3">
<h3>Homework-7 11.15</h3>
<div id="obtain-the-jackknife-estimates-of-bias-and-standard-error-of-hatthetafrachatlambda_1sum_i15hatlambda_i" class="section level4">
<h4>7.8 Obtain the jackknife estimates of bias and standard error of <span class="math display">\[\hat{\theta}=\frac{\hat{\lambda_1}}{\sum_{i=1}^{5}\hat{\lambda_i}}\]</span></h4>
<p>The data has 88 samples, we leave one each time, compute the covariance matrix and estimate <span class="math inline">\(\theta\)</span>. The estimate for bias is <span class="math inline">\((n-1)(\bar{\hat{\theta_{(.)}}-\hat{\theta}})\)</span>. The estimate for variance is <span class="math inline">\(\frac{(n-1)^2}{n}var(\hat{\theta_{(i)}})\)</span> and standard error is the square root of variance.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(bootstrap,<span class="dt">quietly=</span><span class="ot">TRUE</span>)
<span class="kw">data</span>(scor)
scor=<span class="kw">data.matrix</span>(scor)
Sigma=<span class="kw">cov</span>(scor)
lambda=<span class="kw">eigen</span>(Sigma)<span class="op">$</span>values

theta_compute =<span class="st"> </span><span class="cf">function</span>(lambda){
 <span class="kw">return</span>(lambda[<span class="dv">1</span>]<span class="op">/</span><span class="kw">sum</span>(lambda))
}

theta_hat =<span class="st"> </span><span class="kw">theta_compute</span>(lambda)
n=<span class="kw">dim</span>(scor)[<span class="dv">1</span>]
theta_jack =<span class="st"> </span><span class="kw">numeric</span>(n)
<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n){
 Sigma_i=<span class="kw">cov</span>(scor[<span class="op">-</span>i,])
 lambda_i=<span class="kw">eigen</span>(Sigma_i)<span class="op">$</span>values
 theta_jack[i] =<span class="st"> </span><span class="kw">theta_compute</span>(lambda_i)
}

bias_jack =<span class="st"> </span>(n<span class="op">-</span><span class="dv">1</span>)<span class="op">*</span>(<span class="kw">mean</span>(theta_jack)<span class="op">-</span>theta_hat)
var_jack =<span class="st"> </span>(n<span class="op">-</span><span class="dv">1</span>)<span class="op">^</span><span class="dv">2</span><span class="op">*</span><span class="kw">var</span>(theta_jack)<span class="op">/</span>n
se_jack =<span class="st"> </span><span class="kw">sqrt</span>(var_jack)
<span class="kw">round</span>(<span class="kw">c</span>(<span class="dt">original=</span>theta_hat,<span class="dt">bias_jack=</span>bias_jack,
<span class="dt">se_jack=</span>se_jack),<span class="dv">3</span>)</code></pre></div>
<pre><code>#  original bias_jack   se_jack 
#     0.619     0.001     0.050</code></pre>
<p>Using jackknife, the estimated bias is 0.001 and the estimated standard eroor for <span class="math inline">\(\hat{\theta}\)</span> is 0.05.</p>
</div>
<div id="in-example-7.18-leave-one-out-n-fold-cross-validation-was-used-to-select-the-best-fitting-model.-repeat-the-analysis-replacing-the-log-log-model-with-a-cubic-polynomial-model.-which-of-the-four-models-is-selected-by-the-cross-validation-procedure-which-model-is-selected-according-to-maximum-adjusted-r2" class="section level4">
<h4>7.10 In Example 7.18, leave-one-out (n-fold) cross validation was used to select the best fitting model. Repeat the analysis replacing the Log-Log model with a cubic polynomial model. Which of the four models is selected by the cross validation procedure? Which model is selected according to maximum adjusted <span class="math inline">\(R^2\)</span>?</h4>
<p>The four models we consider is<br />
1. Linear: <span class="math inline">\(Y=\beta_0+\beta_1 X+\epsilon\)</span><br />
2. Quadratic: <span class="math inline">\(Y=\beta_0+\beta_1 X +\beta_2 X^2+\epsilon\)</span><br />
3. Exponential: <span class="math inline">\(\log(Y)=\log(\beta_0)+\beta_1 X+\epsilon\)</span><br />
4. Cubic: <span class="math inline">\(Y=\beta_0+\beta_1 X +\beta_2 X^2+\beta_3 X^3+\epsilon\)</span></p>
<p>We use the mean of squared prediction error as the criteria for cross validation approach. Denote <span class="math inline">\(\hat{y_{k.}}\)</span> as the prediction when omitting sample k, <span class="math inline">\(e_k\)</span> as the difference between <span class="math inline">\(y_k\)</span> and <span class="math inline">\(\hat{y_{k.}}\)</span>. Then the mean of squared prediction error is <span class="math inline">\(\frac{1}{n}\sum_{k=1}^{n}e_k^2\)</span>.<br />
The formula for adjusted <span class="math inline">\(R^2\)</span> is <span class="math inline">\(R^2_{adj}=1-[\frac{(1-R^2)(n-1)}{n-k-1}]\)</span>. n is the number of samples and k is the number of non-constant variables in the model. The adjusted <span class="math inline">\(R^2\)</span> increase only if the new term improves the model more than would be expected by chance. It decrease when a predictor improves the model by less than expected by chance.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(ironslag,<span class="dt">package=</span><span class="st">&quot;DAAG&quot;</span>)
<span class="kw">attach</span>(ironslag)
n =<span class="st"> </span><span class="kw">length</span>(magnetic) 
e1 =<span class="st"> </span>e2 =<span class="st"> </span>e3 =<span class="st"> </span>e4 =<span class="st"> </span><span class="kw">numeric</span>(n)
<span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n) {
 y =<span class="st"> </span>magnetic[<span class="op">-</span>k]
 x =<span class="st"> </span>chemical[<span class="op">-</span>k]

 J1 =<span class="st"> </span><span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>x) 
 yhat1 =<span class="st"> </span>J1<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J1<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[k]
 e1[k] =<span class="st"> </span>magnetic[k] <span class="op">-</span><span class="st"> </span>yhat1

 J2 =<span class="st"> </span><span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>x <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(x<span class="op">^</span><span class="dv">2</span>))
 yhat2 =<span class="st"> </span>J2<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J2<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[k] <span class="op">+</span>
<span class="st"> </span>J2<span class="op">$</span>coef[<span class="dv">3</span>] <span class="op">*</span><span class="st"> </span>chemical[k]<span class="op">^</span><span class="dv">2</span>
 e2[k] =<span class="st"> </span>magnetic[k] <span class="op">-</span><span class="st"> </span>yhat2
 

 J3 =<span class="st"> </span><span class="kw">lm</span>(<span class="kw">log</span>(y) <span class="op">~</span><span class="st"> </span>x)
 logyhat3 =<span class="st"> </span>J3<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J3<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[k]
 yhat3 =<span class="st"> </span><span class="kw">exp</span>(logyhat3)
 e3[k] =<span class="st"> </span>magnetic[k] <span class="op">-</span><span class="st"> </span>yhat3
 

 J4 =<span class="st"> </span><span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>x <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(x<span class="op">^</span><span class="dv">2</span>)<span class="op">+</span><span class="st"> </span><span class="kw">I</span>(x<span class="op">^</span><span class="dv">3</span>))
 yhat4 =<span class="st"> </span>J4<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J4<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[k] <span class="op">+</span>
<span class="st"> </span>J4<span class="op">$</span>coef[<span class="dv">3</span>] <span class="op">*</span><span class="st"> </span>chemical[k]<span class="op">^</span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span>J4<span class="op">$</span>coef[<span class="dv">4</span>] <span class="op">*</span><span class="st"> </span>chemical[k]<span class="op">^</span><span class="dv">3</span>
 e4[k] =<span class="st"> </span>magnetic[k] <span class="op">-</span><span class="st"> </span>yhat4
 

}

<span class="kw">round</span>(<span class="kw">c</span>(<span class="dt">spe_1=</span><span class="kw">mean</span>(e1<span class="op">^</span><span class="dv">2</span>), <span class="dt">spe_2=</span><span class="kw">mean</span>(e2<span class="op">^</span><span class="dv">2</span>), 
<span class="dt">spe_3=</span><span class="kw">mean</span>(e3<span class="op">^</span><span class="dv">2</span>), <span class="dt">spe_4=</span><span class="kw">mean</span>(e4<span class="op">^</span><span class="dv">2</span>)),<span class="dv">4</span>)</code></pre></div>
<pre><code>#   spe_1   spe_2   spe_3   spe_4 
# 19.5564 17.8525 18.4419 18.1776</code></pre>
<p>According to the prediction error criterion, Model 2, the quadratic model, with the smallest prediction error, would be the best fit for the data.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">y =<span class="st"> </span>magnetic
x =<span class="st"> </span>chemical
L1 =<span class="st"> </span><span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>x) 
L2 =<span class="st"> </span><span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>x <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(x<span class="op">^</span><span class="dv">2</span>))
L3 =<span class="st"> </span><span class="kw">lm</span>(<span class="kw">log</span>(y) <span class="op">~</span><span class="st"> </span>x)
L4 =<span class="st"> </span><span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>x <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(x<span class="op">^</span><span class="dv">2</span>)<span class="op">+</span><span class="st"> </span><span class="kw">I</span>(x<span class="op">^</span><span class="dv">3</span>))
<span class="kw">round</span>(<span class="kw">c</span>(<span class="dt">adj_R2_1=</span><span class="kw">summary</span>(L1)<span class="op">$</span>adj.r.squared,
        <span class="dt">adj_R2_2=</span><span class="kw">summary</span>(L2)<span class="op">$</span>adj.r.squared,
        <span class="dt">adj_R2_3=</span><span class="kw">summary</span>(L3)<span class="op">$</span>adj.r.squared,
        <span class="dt">adj_R3_3=</span><span class="kw">summary</span>(L4)<span class="op">$</span>adj.r.squared),<span class="dv">4</span>)</code></pre></div>
<pre><code># adj_R2_1 adj_R2_2 adj_R2_3 adj_R3_3 
#   0.5282   0.5768   0.5281   0.5740</code></pre>
<p>According to the adjusted <span class="math inline">\(R^2\)</span> , also the Model 2, with the biggest value, would be the best fit the data. Particularly, we can see that the <span class="math inline">\(R^2_{adj}\)</span> for model 4 is smaller than model 2, which means that adding a cubic term in the model does not improve the model.</p>
<p>The fitted regression equation for Model 2 is:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">L2 =<span class="st"> </span><span class="kw">lm</span>(magnetic <span class="op">~</span><span class="st"> </span>chemical <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(chemical<span class="op">^</span><span class="dv">2</span>))
coef=<span class="kw">round</span>(L2<span class="op">$</span>coef,<span class="dv">3</span>)
<span class="kw">paste</span>(<span class="st">&quot;Magnetic =&quot;</span>,coef[<span class="dv">1</span>],coef[<span class="dv">2</span>],<span class="st">&quot;*Chemical +&quot;</span> ,coef[<span class="dv">3</span>],<span class="st">&quot;*Chemical^2&quot;</span>)</code></pre></div>
<pre><code># [1] &quot;Magnetic = 24.493 -1.393 *Chemical + 0.055 *Chemical^2&quot;</code></pre>
<!-- ### Homework-8 11.22 -->
<!-- ####8.3 Implement a permutation test for equal variance based on the maximum number of extreme points that applies when sample sizes are not necessarily equal.     -->
<!-- We use *function count5num* to compute the maximum number of extreme points, then we use *function count5_test* to do the permutation and compute p value. We reject null hypothesis if the permutation number larger than observed number of extreme points.   -->
<!-- ```{r} -->
<!-- library(boot,quietly = TRUE) -->
<!-- count5num <- function(z,ix,n1) { -->
<!--  z = z[ix] -->
<!--  x = z[1:n1] -->
<!--  y = z[-(1:n1)] -->
<!--  X <- x - mean(x) -->
<!--  Y <- y - mean(y) -->
<!--  outx <- sum(X > max(Y)) + sum(X < min(Y)) -->
<!--  outy <- sum(Y > max(X)) + sum(Y < min(X)) -->
<!--  # return the number of extreme points -->
<!--  return(max(c(outx, outy))) -->
<!-- } -->
<!-- count5_test =function(y,n1){ #Permutation version -->
<!--  boot.obj = boot(data = y, statistic = count5num -->
<!--  ,R = 2000,sim = "permutation",n1=n1) -->
<!--  tb = c(boot.obj$t0, boot.obj$t) -->
<!--  p.value = mean(tb>=tb[1]) #larger t favors alternative -->
<!--  return(as.integer(p.value<0.05)) -->
<!-- } -->
<!-- count5test = function(x, y) { -->
<!--  X = x - mean(x) -->
<!--  Y = y - mean(y) -->
<!--  outx = sum(X > max(Y)) + sum(X < min(Y)) -->
<!--  outy = sum(Y > max(X)) + sum(Y < min(X)) -->
<!--  # return 1 (reject) or 0 (do not reject H0) -->
<!--  return(as.integer(max(c(outx, outy)) > 5)) -->
<!-- } -->
<!-- n1=20;n2=30;m=500 -->
<!-- a1 = mean(replicate(m, expr={ #Count 5 criterion -->
<!--  x = rnorm(n1);y <- rnorm(n2) -->
<!--  x = x - mean(x) #centered by sample mean -->
<!--  y = y - mean(y) -->
<!--  count5test(x, y) -->
<!-- })) -->
<!-- a2 = mean(replicate(m, expr={ #Permutation test -->
<!--  x1 = rnorm(n1);x2 = rnorm(n2) -->
<!--  y=c(x1,x2) -->
<!--  count5_test(y,n1) -->
<!-- })) -->
<!-- round(c(c5_t1e=a1,pt_t1e=a2),3) -->
<!-- ``` -->
<!-- When $n_1=20,n_2=30$, we can see that the empirical tyep-I error of permutation test is smaller than count-5 test when example sizes are different. Thus, using permutation test can better control type-I error than count 5 criterion.    -->
<!-- ```{r} -->
<!-- n2=50;m=500 -->
<!-- a1 = mean(replicate(m, expr={ #Count 5 criterion -->
<!--  x = rnorm(n1);y <- rnorm(n2) -->
<!--  x = x - mean(x) #centered by sample mean -->
<!--  y = y - mean(y) -->
<!--  count5test(x, y) -->
<!-- })) -->
<!-- a2 = mean(replicate(m, expr={ #Permutation test -->
<!--  x1 = rnorm(n1);x2 = rnorm(n2) -->
<!--  y=c(x1,x2) -->
<!--  count5_test(y,n1) -->
<!-- })) -->
<!-- round(c(c5_t1e=a1,pt_t1e=a2),3) -->
<!-- ``` -->
<!-- This also make sense when $n_2=50$, thus we can come to the conclusion that using permutation test can better control type-I error than count 5 criterion.   -->
<!-- ####2. Power comparison (distance correlation test versus ball covariance test)  X ∼ $N(0_2, I_2)$, $e ∼ N(0_2, I_2)$, X and e are independent    -->
<!-- ####Model 1: $Y = \frac{X}{4} + e$ -->
<!-- ```{r} -->
<!-- library(snowfall,quietly=TRUE) -->
<!-- Akl = function(x) { -->
<!--  d = as.matrix(dist(x)) -->
<!--  m = rowMeans(d); M = mean(d) -->
<!--  a = sweep(d, 1, m); b = sweep(a, 2, m) -->
<!--  return(b+M) -->
<!-- } -->
<!-- dCov = function(x, y) { -->
<!--  x = as.matrix(x); y = as.matrix(y) -->
<!--  n = nrow(x); m = nrow(y) -->
<!--  if (n != m || n < 2) stop("Sample sizes must agree") -->
<!--  if (! (all(is.finite(c(x, y))))) -->
<!--  stop("Data contains missing or infinite values") -->
<!--  A = Akl(x); B = Akl(y) -->
<!--  sqrt(mean(A * B)) -->
<!-- } -->
<!-- ndCov2 = function(z, ix, dims) { -->
<!--  #dims contains dimensions of x and y -->
<!--  p = dims[1] -->
<!--  q = dims[2] -->
<!--  d = p + q -->
<!--  x = z[ , 1:p] #leave x as is -->
<!--  y = z[ix, -(1:p)] #permute rows of y -->
<!--  return(nrow(z) * dCov(x, y)^2) -->
<!-- } -->
<!-- dcov.test= function(z){ -->
<!--  boot.obj = boot(data = z, statistic = ndCov2, R = 999, -->
<!--  sim = "permutation", dims = c(2, 2)) -->
<!--  tb = c(boot.obj$t0, boot.obj$t) -->
<!--  return(p.cor = mean(tb>=tb[1])) -->
<!-- } -->
<!-- run_cop1 = function(n){ -->
<!-- for (i in 1:10){ -->
<!--  x = rmvnorm(n,mu=c(0,0),sigma=diag(1,2)) -->
<!--  e = rmvnorm(n,mu=c(0,0),sigma=diag(1,2)) -->
<!--  y = x/4+e -->
<!--  z = cbind(x,y) -->
<!--  p1.values[i,1] = dcov.test(z) -->
<!--  p1.values[i,2] = bcov.test(z[,1:2],z[,3:4],R=999,seed=i+1)$p.value -->
<!-- } -->
<!--  return(colMeans(p1.values<0.1)) -->
<!-- } -->
<!-- p1.values=matrix(0,ncol=2,nrow=10) -->
<!-- sfInit(parallel = TRUE, cpus = 10) -->
<!-- sfLibrary(mixtools) -->
<!-- sfLibrary(Ball) -->
<!-- sfLibrary(boot) -->
<!-- sfExport("Akl","dCov","ndCov2","dcov.test") -->
<!-- sfExport("p1.values") -->
<!-- n = seq(50,200,20) -->
<!-- result1 = sfLapply(n, run_cop1)  #Model 1 -->
<!-- result1=matrix(unlist(result1),ncol=2,byrow=T) -->
<!-- plot(n,result1[,1],type="b",pch=20,ylab="Power",main="Model 1",ylim=c(0,1.1)) -->
<!-- lines(n,result1[,2],type="b",lty=2) -->
<!-- legend(140,0.3,c("Distance","Ball"),lty=1:2) -->
<!-- t1=t(result1);colnames(t1)=as.character(n);rownames(t1)=c("Distance","Ball") -->
<!-- knitr::kable(t1) -->
<!-- ``` -->
<!-- ####Model 2: $Y = \frac{X}{4} \cdot e$   -->
<!-- ```{r} -->
<!-- run_cop2 = function(n){ -->
<!-- for (i in 1:10){ -->
<!--  x = rmvnorm(n,mu=c(0,0),sigma=diag(1,2)) -->
<!--  e = rmvnorm(n,mu=c(0,0),sigma=diag(1,2)) -->
<!--  y = x/4*e -->
<!--  z = cbind(x,y) -->
<!--  p2.values[i,1] = dcov.test(z) -->
<!--  p2.values[i,2] = bcov.test(z[,1:2],z[,3:4],R=999,seed=i+1)$p.value -->
<!-- } -->
<!--  return(colMeans(p2.values<0.1)) -->
<!-- } -->
<!-- p2.values=matrix(0,ncol=2,nrow=10) -->
<!-- sfExport("p2.values") -->
<!-- n = seq(50,200,20) -->
<!-- result2 = sfLapply(n, run_cop2)  #Model 2 -->
<!-- result2=matrix(unlist(result2),ncol=2,byrow=T) -->
<!-- plot(n,result2[,1],type="b",pch=20,ylab="Power",main="Model 2",ylim=c(0,1.1)) -->
<!-- lines(n,result2[,2],type="b",lty=2) -->
<!-- legend(140,0.3,c("Distance","Ball"),lty=1:2) -->
<!-- t2=t(result2);colnames(t2)=as.character(n);rownames(t2)=c("Distance","Ball") -->
<!-- knitr::kable(t2) -->
<!-- ``` -->
<!-- From the curves and the tables, we can see that in Model 1, distance correlation test has larger power, but in Model 2, Ball covariance test has larger power. -->
</div>
</div>
<div id="homework-9-11.29" class="section level3">
<h3>Homework-9 11.29</h3>
<div id="implement-a-random-walk-metropolis-sampler-for-generating-the-standard-laplace-distribution-see-exercise-3.2.-for-the-increment-simulate-from-a-normal-distribution.-compare-the-chains-generated-when-different-variances-are-used-for-the-proposal-distribution.-also-compute-the-acceptance-rates-of-each-chain." class="section level4">
<h4>9.4 Implement a random walk Metropolis sampler for generating the standard Laplace distribution (see Exercise 3.2). For the increment, simulate from a normal distribution. Compare the chains generated when different variances are used for the proposal distribution. Also, compute the acceptance rates of each chain.</h4>
<p>The standard Laplace distribution has density <span class="math inline">\(f(x)=\frac{1}{2}e^{-|x|},x\in\mathbb{R}\)</span>, it is proportional to <span class="math inline">\(e^{-|x|}\)</span><br />
<span class="math display">\[r(X_t,Y)=\frac{f(Y)}{f(X_t)}=e^{|X_t|-|Y|}\]</span> Random Walk Metropolis: <span class="math inline">\(g(r|s)=g(|s-r|)\)</span></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">8888</span>)
f =<span class="st"> </span><span class="cf">function</span>(x) {
  <span class="kw">return</span>(<span class="kw">exp</span>(<span class="op">-</span><span class="kw">abs</span>(x)))
}
random.M =<span class="st"> </span><span class="cf">function</span>(sigma, x0, N){
 x =<span class="st"> </span><span class="kw">numeric</span>(N)
 x[<span class="dv">1</span>] =<span class="st"> </span>x0
 u =<span class="st"> </span><span class="kw">runif</span>(N)
 rej =<span class="st"> </span><span class="dv">0</span>
 <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>N) {
  y =<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1</span>, x[i<span class="op">-</span><span class="dv">1</span>], sigma)
  <span class="cf">if</span> (u[i] <span class="op">&lt;=</span><span class="st"> </span>(<span class="kw">f</span>(y) <span class="op">/</span><span class="st"> </span><span class="kw">f</span>(x[i<span class="op">-</span><span class="dv">1</span>]))) x[i] =<span class="st"> </span>y 
  <span class="cf">else</span> {x[i] =<span class="st"> </span>x[i<span class="op">-</span><span class="dv">1</span>];rej=rej<span class="op">+</span><span class="dv">1</span>}
 }
 <span class="kw">return</span>(<span class="kw">list</span>(<span class="dt">x=</span>x, <span class="dt">rej=</span>rej))
}
N=<span class="dv">2000</span>
sigma =<span class="st"> </span><span class="kw">c</span>(.<span class="dv">05</span>, .<span class="dv">5</span>, <span class="dv">2</span>, <span class="dv">16</span>)
x0=<span class="dv">20</span>
R1=<span class="kw">random.M</span>(sigma[<span class="dv">1</span>],x0,N)
R2=<span class="kw">random.M</span>(sigma[<span class="dv">2</span>],x0,N)
R3=<span class="kw">random.M</span>(sigma[<span class="dv">3</span>],x0,N)
R4=<span class="kw">random.M</span>(sigma[<span class="dv">4</span>],x0,N)
<span class="co">#number of candidate points rejected</span>
Rej=<span class="kw">cbind</span>(R1<span class="op">$</span>rej, R2<span class="op">$</span>rej, R3<span class="op">$</span>rej, R4<span class="op">$</span>rej)
Rej=<span class="st"> </span><span class="kw">round</span>((N<span class="op">-</span>Rej)<span class="op">/</span>N,<span class="dv">3</span>)
<span class="kw">rownames</span>(Rej)=<span class="st">&quot;Accept rates&quot;</span>;<span class="kw">colnames</span>(Rej)=<span class="kw">paste</span>(<span class="st">&quot;sigma&quot;</span>,sigma)
knitr<span class="op">::</span><span class="kw">kable</span>(Rej)</code></pre></div>
<table>
<thead>
<tr class="header">
<th></th>
<th align="right">sigma 0.05</th>
<th align="right">sigma 0.5</th>
<th align="right">sigma 2</th>
<th align="right">sigma 16</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Accept rates</td>
<td align="right">0.979</td>
<td align="right">0.828</td>
<td align="right">0.524</td>
<td align="right">0.096</td>
</tr>
</tbody>
</table>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))
<span class="kw">plot</span>(<span class="dv">1</span><span class="op">:</span>N,R1<span class="op">$</span>x,<span class="dt">type=</span><span class="st">'l'</span>,<span class="dt">ylab=</span><span class="st">'N'</span>,<span class="dt">main=</span><span class="kw">paste</span>(<span class="st">&quot;sigma=&quot;</span>,sigma[<span class="dv">1</span>]))</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(<span class="dv">1</span><span class="op">:</span>N,R2<span class="op">$</span>x,<span class="dt">type=</span><span class="st">'l'</span>,<span class="dt">ylab=</span><span class="st">'N'</span>,<span class="dt">main=</span><span class="kw">paste</span>(<span class="st">&quot;sigma=&quot;</span>,sigma[<span class="dv">2</span>]))</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(<span class="dv">1</span><span class="op">:</span>N,R3<span class="op">$</span>x,<span class="dt">type=</span><span class="st">'l'</span>,<span class="dt">ylab=</span><span class="st">'N'</span>,<span class="dt">main=</span><span class="kw">paste</span>(<span class="st">&quot;sigma=&quot;</span>,sigma[<span class="dv">3</span>]))</code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAmVBMVEUAAAAAADoAAGYAOjoAOmYAOpAAZpAAZrY6AAA6ADo6AGY6OgA6Ojo6OmY6OpA6ZpA6ZrY6kLY6kNtmAABmOgBmOjpmkLZmtttmtv+QOgCQZgCQZjqQkGaQkLaQttuQtv+Q2/+2ZgC2Zjq2kGa229u22/+2///bkDrbkGbbtmbbtpDb27bb////tmb/25D/27b//7b//9v///8PBLyhAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAI1UlEQVR4nO2dC5vaKBhGmXa62p29Ou227lW729qLzij//8dtEkICAfKiEoPxPc/TqSbwBc4AIUoyQpJexNgFyB0KAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIkIWgw1K82p6e/fmtEOLHj+nKYzIBQbu5KLlbJSxRSxaCzqKw+2Iln+ZnNcIwYwr6/FD83n/+2LSgwwch7ldr8eLT/lHMvj6Iu3fy87zYVCb++qbsR8XLJ9VgmiazfzufFf+V2YYo5IiCNqqeRb2UoOJnWe0HJUjxUKeQu0ZKV1DN9ASVrWQrvwixqAUVDmbbw1rUghblPvGu9Fil+G5bulkEBE2wixVVuv9PvVSCVBso3FSCig3qZ2Wl5Nu/RXua+YOVRt8PUszxBKke9fK3bS1In8r0GKTamKwFHf5QzcYv6LnwM0wDGnMMen6jeso/SpDSERBU2rz/61u5wdPFyk0D+Rn3NP/8ZzkI142ntwWpZrT3CxrSz+jzoMPvhQ/fGGQL2lVDjH+Q3g/Xv+SYgoo6/7ot+5luPPZZzGlBr7bPS+8YtB7Sz5gt6EPTEHzzIHcMCgzSTYua2jxIyi8P9UWmMZP+6WP4LHb/98ZjoZ5vTlGQn/WQHeZ4MhJUjCW/VA0mMBkch4wE7bzXWGOTkSD5/HZeX95nRE6CsoSCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQESCxIXA1jCUobbjgoCEBBgAsL6nTtK9A0bguiIBQuf0MUBKAgAAUBKAhAQQAKAlAQgIIAgwjaPy6kuqUieOcRBclNebPS/jFwDzYF1Wo2gXu6KOhpXgnaBToZBbEF9aAeOTKTergOh7tRQbJydLcqTmSL/nC3KygyHAV1o3S+TaEgEI6CQLgbFdQ8OCt8sXHbguRhiR7/cOOCCkPgqQi3LqiYAfU/KezmBUWGi188MRYUBKAgAAUBKAhAQQAKAlAQgIIAFAQYWVD+1xoUBBj5I1cKQuEoCISjIBCOgkA4CgLhKAiEoyAQjoJAuKkJivhK8LjjTk1Qyzq4suWocFMVVLSk8/5CzsQF7c7+ywLTFrQ5/+8RTFnQYXne8GOFm6Cgs4cfK9z0BMUMP/G3IkxP0Cbmr33E34owOUFxE8X4heSTExRH+FYEfuRawRYEiL8VIZWg4TwPdTUfeSvCuTUbviFm8XHH6bHPWrEflSlzQf49wvnqOr50xpfd1yUoqMJzcI8g4UvnjXi9gnxHOFoQLGafoCaukOFEwcCxCY8Ll1yQ6CR0Il6bIN29IgWJuhatGNGEqQX11854rp3d6kS+gup/wre7e3BRSRBxgtzVRyJa0NETiIEESY8gt3hAUPtMtGpXM+b3CGrPC40gkakgUQsy6qWrpptHu0XJEW2lGkG1kY6g9rU+bLVJmIJMua1Yo2EdWaM0dASJpi7CL0jv15e6baW0oCaVeqV3S1eQ2q9TuYJ0zOPqfQFBegTRgvS7ZrcpqDHQ5DY+KQgJMlLUQtv+abS+bAXpBmEIEoYgYVWw6Vt+mjob401XY/PTKELbDrMRJKAgu0ptjfoE6fbWjDdOaul91/3IKg9B/go6gqzq9NoxBVl9c0qC9H+BJEiQ1YVgYk+4I+udRlD38IGSm+mwiUAtpTDbBWxw7pYxBPnCBeoWLHhns3R+WhscRZ5fijs6NWN0HoLMCZ/0ldgjRFrv28Fet5tWkKnKmD8YUc3xRza5chIk/YJ8DUlK04hXkJ5vyyhB7Xgv27zGGHlCjVIg7Nf65C58BbfOWdKe80pjSiQbQdIQpDPU3aYjSF6jIBkUVNdedgVJPRu02ohxAHtcURu7gpoo1uw7Q0F6ptiOp1JiQVJiQXYJ9CYdXxcrS0HSI8i8njIr0ydImjuMA/gESY8gKfMW1P7fEaQrU/ck6RckA4Jkv6BOgfITZG8UUpolNEcHeYwgO7J7vG4KO22egvQeZyy18xkpRDd5k6v/vVuCjqCIgvbHO5fecBcRFD7m8IKOWGEWcdyTBHXfZygoboVZzJF7BDk9MhAeCwplHkxQ5PqgmCO7Z7wpCIp72O3Rh3by+QWdxbW1IDigX6Og8twTtcLs7EOnttMNOdRpPrDCzPj8Ip5JCrpwuKRcTNBhuUgZ7mJQEICCABQEoCAAz2IACgJQEICCjoGCABQEoCDAaIKuhpEEHRc0Mt0oyU5MnjYoBaVJR0E5JjsxedqgFJQmHQXlmOzE5GmDUlCadNMTNCUoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQIL2gnRB3q+DedqVsk64/Qx9P339KHdIhuaBduQo2XLqn16tOOpChh/1jtZw9ZUiX1ILU6qp18NnCeol+kw5lCLOrb6pJGNJDakHqVoVN8HagzayTDmUIshMLpSZdSB/JBVXtPXQrR/F7/aEYLxZGOpShD5UraUiH1IJU1w8OAPvH8iaP9aJNBzL0H6x0kDakw4UF1YlefEonKG1Ih0t3MZVo/j5hF0sa0uHSg7RK9HqVZEQ1BSUK6XDh07wqe1GxJOfkSlDakA6XnihWxS5G1CSzuvosljKkQ/pLjU3/NH9dnJPfW+lAhh7qLpYypAMvVgEUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgQM6C1CpfWS4Zqb+EDzyDeEgyFlSv8pWloGoZNAVZ7NpH5x+WL6tFYxRkoFf5HpbliqhZtdaXgmx2bQuaVU9CpyAbU1D1kHgKsrEElQsPKcjGElS+oyAbW5BcLyjIpiPo6fUDBVl0BMm1oCALcx5Uvle3rVyYnAVlAQUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBPgfP6iPu4zFNzIAAAAASUVORK5CYII=" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(<span class="dv">1</span><span class="op">:</span>N,R4<span class="op">$</span>x,<span class="dt">type=</span><span class="st">'l'</span>,<span class="dt">ylab=</span><span class="st">'N'</span>,<span class="dt">main=</span><span class="kw">paste</span>(<span class="st">&quot;sigma=&quot;</span>,sigma[<span class="dv">4</span>]))</code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAmVBMVEUAAAAAADoAAGYAOjoAOmYAOpAAZpAAZrY6AAA6ADo6AGY6OgA6Ojo6OmY6OpA6ZpA6ZrY6kLY6kNtmAABmOgBmOjpmkLZmtttmtv+QOgCQZgCQZjqQkGaQkLaQttuQtv+Q2/+2ZgC2Zjq2kGa229u22/+2///bkDrbkGbbtmbbtpDb27bb////tmb/25D/27b//7b//9v///8PBLyhAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAIn0lEQVR4nO2d62KbNgCFlTat3WVdO6db413jtY17sZNY7/9wEwiQhBAHbGFkON+PxNjigL5IAscCC0laEWPvQOpQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBgLEFHdbi1e6khE0Z8O1GiOsvMXbK5tIFHf4TRYB6oLi6j7RjJWMLOpHvH0QhaC/ER/m4vFpF3sJIgr6q7nD17kvVgrKGcH2/ES8enm/F4vuNuPoovy7VU1nh3MJb9fBxKYTTTrbq4VIL2pzaVQOMI2ir6/nioRCkfmbVvtGCNDdFiaxtFFIaBF1/1obVaq+V5HfRJY0iKGslO/lNiFUhSDlY7A4bUQhaZa+pHrMtSrzeZW5WvqCv73dFEyxfyoxGZRRBqjbXn/VDXb9NXjHlJhekntA/cysZPz6p9rRozLIErbTzuIwiSPeol7/vivqVh7JyDNJtTBaCDn/qxoEEVR02KuOMQU8fdE/5V1dJ6wgIymxe//0je8LrYtIWlP3aRO9jYx3mn/66yQ/QuAXpZvQMBOk+OSFBisMfqjZNY5ArSA3gdzIwSEtznrDOI+If7EcRpOr86y7rZ2XjcY9iXgt6tXtagzFIR3xfTmOQLt4WZA2h6TzIH4PwIJ01HlGeVcdkpC6WvbEUb90z6V++hI9i1/9sA6NLJejwSXXA99M4UQwx1NuFU0hDkOoe7/MG09yNxiQNQXv/6JQKaQiST78ti7f3qZGIoHShIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASILEhfDWILixg0HBQEoCHBmQbWu3b2Hj8bILYiCQBwFgTgKAnEUBOIoCMRREIijIBBHQSCOgkAcBYE4CgJxMxX0fLuS+sqc4JWzFCS3+hrju9a4GQsq1GwDlwZS0OMyF7QPdDIKYgtqQd+5ZiHL4TocN1NBMnd0da8OZKv2uPkK6hhHQfWU2udxFATiKAjEzVRQdf+18JuNeQuShzW6fdHMBSlD4OYacxekzoAC71LduPkK6hhHQSCOgkAcBYE4CgJxFATiKAjEURCIoyAQR0EgjoJAHAWBOAoCcRQE4iionsJ/2veLoyAQR0EgjoJA3OQEdfhAp9d2JyfIsDntawWmLki1pPZPLTrGTVXQ/uTvNZm2oO3pX0owZUGHdYRvNZmwoJOHHztugoJOH37suOkJ2kb6yo+pCuKJ4ukFe8VREIg7LvWcWiko1rb67NTQl0NNQ9CAl0NNQtCQF7NMQlDz5VBx/mk/CUGdW9ARtZ2AoB6XQ81RkOxzOdRMBXWMoyAQd4ygPjc3PB0KQluLXrBX3FiCugekI6hzrYcT1PTsXAU1RqQoSBSPxLlb0IUIkragjptwBLWvFHyRgtyteMsU5G7FW64EicaXGx+h3epasF9cf0HV/wI63BB7noLKksJ+2L4Vb7narC8oj0xZkL8hUVvqKKjhJFSUSmxB5i9jXkpIkOgjSPcpT1Bz26vqaV5uFiTrgpxBrm+NImH2uaugouWLqgJ1QbYrIQQWVAxhlqAi1j7GJSLIjLcNraHabVuQqAtyGpOQ/QTZObJI71nvoQTJJkG1sVPvcZsgUbZBt0EWa9ljc0CQOSZWz/SsdxxB9X/aywZBwhVkr2ILEna1yl4nfEHVS7JS7Qmq/jaWoGCPD1XtNDPhuLqgar9N5aUxYgkqG4gTa61lhpe6oCrKLlsX1LfewwlyW5XZcVPAVAwJMqOOL8gS7XRQmbwg/dMI8oagsvWYpaAgp5CTaay1CTLt2NvRzjWKQv042iZINgiqumNzunCSzNiLBNlHwfqOdq5RFAKCrD5hF7AESWupq6Cq89QEWRsv10pckDijIGEJMmtdiCC/tP10pBZkbdzsSbqCzGGmsXRAUGC3fEG2FT+wtqa09iMxQcHSomm5g6ByWUi71l6gu6b1OxlB8khBYBOOoJZAf+VLE9S4jAWZ7PprlyOoeqaHoPanG16dhKDQIenYjU9QUNyN10+mjgscRFD3acDOM0P+DY7OHk5Qp2nAzjPzEtRtEufRm+hAnLjBBHX7VoSjN9GBxAUd0YIik7Sg7KSmyzTg9BnqMB+YBuz+e/USSOc8KFGGFHRYr2LGjcNogi6GkQT1C+1YbpRiRxbPoCAABZ0MBUUKpaA45SgoxWJHFo8bSkFxyk1P0JSgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBgPiC9kJc3QdfNR9fV+XaV2jj8aeH2JEe0QXts4+mw3v3+Oa+Vg6s0MLzbT7HJGakT2xB+iOPTfDewuW8maocWiHMvpjpFjGygdiC9PyhbXCO3nZRK4dWCLIXK60mXmQT0QXl7T00v0r9XX9W48XKKodWaEOvFTXSI7Yg3fWDA8DzbTbzarMy5cAK7RvLHMSN9DizoKLQi4d4guJGepy7i+lCy7uIXSxqpMe5B2ld6M19lBHVFhQp0uPMh3m976piUY7JuaC4kR7nPlHMd1uNqFHO6oqjWMxIj/hvNbbtp/kbdUy+c8qBFVoouljMSA++WQVQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCACkL0rN8ZTZlpPgQPnBjsCFJWFAxy1dmgvJp0BTksDf3szysX+aTxijIopzle1hnM6IW+VxfCnLZmxa0yG9PSEEutqD8zo0U5OIIyiYeUpCLIyhboiAXV5DcrCjIpSbo8c0NBTnUBMmNoCAH+zwoW9aXrZyZlAUlAQUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBPgftxsnvwW3NzQAAAAASUVORK5CYII=" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(rmutil,<span class="dt">quietly=</span><span class="ot">TRUE</span>)
p =<span class="st"> </span><span class="kw">c</span>(.<span class="dv">05</span>, <span class="kw">seq</span>(.<span class="dv">1</span>, .<span class="dv">9</span>, .<span class="dv">1</span>), .<span class="dv">95</span>)
Q =<span class="st"> </span><span class="kw">qlaplace</span>(p)
R_all =<span class="st"> </span><span class="kw">cbind</span>(R1<span class="op">$</span>x, R2<span class="op">$</span>x, R3<span class="op">$</span>x, R4<span class="op">$</span>x)
MC =<span class="st"> </span>R_all[<span class="dv">501</span><span class="op">:</span>N, ]
QR =<span class="st"> </span><span class="kw">apply</span>(MC, <span class="dv">2</span>, <span class="cf">function</span>(x) <span class="kw">quantile</span>(x, p))
<span class="kw">colnames</span>(QR)=<span class="kw">paste</span>(<span class="st">&quot;sigma&quot;</span>,sigma)
knitr<span class="op">::</span><span class="kw">kable</span>(<span class="kw">round</span>(<span class="kw">cbind</span>(<span class="dt">real_q=</span>Q, QR),<span class="dv">3</span>))</code></pre></div>
<table>
<thead>
<tr class="header">
<th></th>
<th align="right">real_q</th>
<th align="right">sigma 0.05</th>
<th align="right">sigma 0.5</th>
<th align="right">sigma 2</th>
<th align="right">sigma 16</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>5%</td>
<td align="right">-2.303</td>
<td align="right">19.202</td>
<td align="right">-1.950</td>
<td align="right">-1.977</td>
<td align="right">-2.046</td>
</tr>
<tr class="even">
<td>10%</td>
<td align="right">-1.609</td>
<td align="right">19.402</td>
<td align="right">-1.136</td>
<td align="right">-1.440</td>
<td align="right">-1.723</td>
</tr>
<tr class="odd">
<td>20%</td>
<td align="right">-0.916</td>
<td align="right">19.573</td>
<td align="right">-0.655</td>
<td align="right">-0.783</td>
<td align="right">-0.633</td>
</tr>
<tr class="even">
<td>30%</td>
<td align="right">-0.511</td>
<td align="right">19.794</td>
<td align="right">-0.328</td>
<td align="right">-0.406</td>
<td align="right">-0.271</td>
</tr>
<tr class="odd">
<td>40%</td>
<td align="right">-0.223</td>
<td align="right">19.962</td>
<td align="right">-0.086</td>
<td align="right">-0.142</td>
<td align="right">-0.081</td>
</tr>
<tr class="even">
<td>50%</td>
<td align="right">0.000</td>
<td align="right">20.210</td>
<td align="right">0.080</td>
<td align="right">0.006</td>
<td align="right">0.074</td>
</tr>
<tr class="odd">
<td>60%</td>
<td align="right">0.223</td>
<td align="right">20.401</td>
<td align="right">0.334</td>
<td align="right">0.251</td>
<td align="right">0.260</td>
</tr>
<tr class="even">
<td>70%</td>
<td align="right">0.511</td>
<td align="right">20.548</td>
<td align="right">0.698</td>
<td align="right">0.531</td>
<td align="right">0.605</td>
</tr>
<tr class="odd">
<td>80%</td>
<td align="right">0.916</td>
<td align="right">20.757</td>
<td align="right">1.091</td>
<td align="right">0.905</td>
<td align="right">1.045</td>
</tr>
<tr class="even">
<td>90%</td>
<td align="right">1.609</td>
<td align="right">21.131</td>
<td align="right">1.627</td>
<td align="right">1.487</td>
<td align="right">1.429</td>
</tr>
<tr class="odd">
<td>95%</td>
<td align="right">2.303</td>
<td align="right">21.337</td>
<td align="right">2.197</td>
<td align="right">2.131</td>
<td align="right">1.845</td>
</tr>
</tbody>
</table>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#xtable::xtable(round(cbind(real_q=Q, QR),3))</span>
real=<span class="kw">rlaplace</span>(N)
<span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))
<span class="kw">qqplot</span>(MC[,<span class="dv">1</span>],real,<span class="dt">pch=</span><span class="dv">20</span>,<span class="dt">col=</span><span class="st">'red'</span>,<span class="dt">main=</span><span class="kw">paste</span>(<span class="st">&quot;sigma=&quot;</span>,sigma[<span class="dv">1</span>]));
<span class="kw">qqline</span>(MC[,<span class="dv">1</span>],<span class="dt">distribution=</span>qlaplace,<span class="dt">lwd=</span><span class="fl">1.9</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">qqplot</span>(MC[,<span class="dv">2</span>],real,<span class="dt">pch=</span><span class="dv">20</span>,<span class="dt">col=</span><span class="st">'red'</span>,<span class="dt">main=</span><span class="kw">paste</span>(<span class="st">&quot;sigma=&quot;</span>,sigma[<span class="dv">2</span>]));
<span class="kw">qqline</span>(MC[,<span class="dv">2</span>],<span class="dt">distribution=</span>qlaplace,<span class="dt">lwd=</span><span class="fl">1.9</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">qqplot</span>(MC[,<span class="dv">3</span>],real,<span class="dt">pch=</span><span class="dv">20</span>,<span class="dt">col=</span><span class="st">'red'</span>,<span class="dt">main=</span><span class="kw">paste</span>(<span class="st">&quot;sigma=&quot;</span>,sigma[<span class="dv">3</span>]));
<span class="kw">qqline</span>(MC[,<span class="dv">3</span>],<span class="dt">distribution=</span>qlaplace,<span class="dt">lwd=</span><span class="fl">1.9</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">qqplot</span>(MC[,<span class="dv">4</span>],real,<span class="dt">pch=</span><span class="dv">20</span>,<span class="dt">col=</span><span class="st">'red'</span>,<span class="dt">main=</span><span class="kw">paste</span>(<span class="st">&quot;sigma=&quot;</span>,sigma[<span class="dv">4</span>]));
<span class="kw">qqline</span>(MC[,<span class="dv">4</span>],<span class="dt">distribution=</span>qlaplace,<span class="dt">lwd=</span><span class="fl">1.9</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>We can see that when <span class="math inline">\(\sigma = 0.05\)</span>, the acceptance rate is 0.979, really close to 1 and the behavior of the chain was like a random walk, without any convergent trends. When <span class="math inline">\(\sigma=0.5\)</span>, the chain converged slowly. When <span class="math inline">\(\sigma=2\)</span>, the chain converged quickly with a lower acceptance rate: 0.524. When <span class="math inline">\(\sigma=16\)</span>, we can see the acceptance rate was small and thus the simulation was very inefficient.</p>
<p>As for the qqplot, the quantiles of simulation 1 were far from theoretical ones. For simulation 2 and 3, the simulated quantiles are extremely close to theoretical ones. When <span class="math inline">\(\sigma=16\)</span>, the simulation was still close to theory, but acceptance rates were much lower. Together with acceptance rates and convergent speeds, I thought simulation 3 (<span class="math inline">\(\sigma=2\)</span>) was the best one. Besides, the variance of proposed distribution greatly influenced the simulation effect.</p>
<p>P.s: If I choose <span class="math inline">\(x_0=0\)</span>, then it won’t have the sharp decrease at the beginning. Considering we only focus on the later part of the chain and we have the burn-in process, the value of <span class="math inline">\(x_0\)</span> doesn’t matter much.</p>
</div>
</div>
<div id="homework-10-12.6" class="section level3">
<h3>Homework-10 12.6</h3>
<div id="the-natural-logarithm-and-exponential-functions-are-inverses-of-each-other-so-that-mathematically-logexp-x-explog-x-x.-show-by-example-that-this-property-does-not-hold-exactly-in-computer-arithmetic.-does-the-identity-hold-with-near-equality-see-all.equal." class="section level4">
<h4>11.1 The natural logarithm and exponential functions are inverses of each other, so that mathematically <strong>log(exp x) = exp(log x) = x</strong>. Show by example that this property does not hold exactly in computer arithmetic. Does the identity hold with near equality? (See all.equal.)</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">a=<span class="dv">3</span>
<span class="kw">log</span>(<span class="kw">exp</span>(a))<span class="op">==</span><span class="kw">exp</span>(<span class="kw">log</span>(a));<span class="kw">isTRUE</span>(<span class="kw">all.equal</span>(<span class="kw">log</span>(<span class="kw">exp</span>(a)),<span class="kw">exp</span>(<span class="kw">log</span>(a))))</code></pre></div>
<pre><code># [1] FALSE</code></pre>
<pre><code># [1] TRUE</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">a=<span class="dv">5</span>
<span class="kw">log</span>(<span class="kw">exp</span>(a))<span class="op">==</span><span class="kw">exp</span>(<span class="kw">log</span>(a));<span class="kw">isTRUE</span>(<span class="kw">all.equal</span>(<span class="kw">log</span>(<span class="kw">exp</span>(a)),<span class="kw">exp</span>(<span class="kw">log</span>(a))))</code></pre></div>
<pre><code># [1] FALSE</code></pre>
<pre><code># [1] TRUE</code></pre>
<p>We can see that if choosing a=3/5, the property does not hold, but it holds with near equality.</p>
</div>
<div id="write-a-function-to-solve-the-equation-for-a" class="section level4">
<h4>11.5 Write a function to solve the equation for <span class="math inline">\(a\)</span></h4>
<p><span class="math display">\[\frac{2\Gamma(\frac{k}{2})}{\sqrt{\pi (k-1)} \Gamma(\frac{k-1}{2})}\int_0^{c_{k-1}}(1+\frac{u^2}{k-1})^{-k/2}du\]</span> <span class="math display">\[=\frac{2\Gamma(\frac{k+1}{2})}{\sqrt{\pi k} \Gamma(\frac{k}{2})}\int_0^{c_{k}}(1+\frac{u^2}{k})^{-(k+1)/2}du\]</span> where <span class="math display">\[c_k=\sqrt{\frac{a^2k}{k+1-a^2}}\]</span> Compare the solutions with the points <span class="math inline">\(A(k)\)</span> in Exercise 11.4</p>
<p>I define function <em>f</em> to compute one side of the equation and solve the equation in function <em>solve_eq</em>. For Exercise 11.4, I define function <em>Sk</em> to compute one end of the curve and find the intersection points using <em>solve_ist</em>. I found the roots lying between 1 and 2 by attempting, thus I set the lower=1 and upper=2 in <em>uniroot</em>. There are two ways to compute Exercise 11.5, one uses numerical integration and the other uses the probability function of t distribution directly. I listed the both here and commented on one.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">f =<span class="st"> </span><span class="cf">function</span>(k,a){
 ck=<span class="kw">sqrt</span>(a<span class="op">^</span><span class="dv">2</span><span class="op">*</span>k<span class="op">/</span>(k<span class="op">+</span><span class="dv">1</span><span class="op">-</span>a<span class="op">^</span><span class="dv">2</span>))
 int=<span class="kw">integrate</span>(<span class="cf">function</span>(u){(<span class="dv">1</span><span class="op">+</span>u<span class="op">^</span><span class="dv">2</span><span class="op">/</span>k)<span class="op">^</span>(<span class="op">-</span>(k<span class="op">+</span><span class="dv">1</span>)<span class="op">/</span><span class="dv">2</span>)},<span class="dv">0</span>,ck)<span class="op">$</span>value
 mul=<span class="dv">2</span><span class="op">/</span><span class="kw">sqrt</span>(pi<span class="op">*</span>k)<span class="op">*</span><span class="kw">exp</span>(<span class="kw">lgamma</span>((k<span class="op">+</span><span class="dv">1</span>)<span class="op">/</span><span class="dv">2</span>)<span class="op">-</span><span class="kw">lgamma</span>(k<span class="op">/</span><span class="dv">2</span>))
 mul<span class="op">*</span>int
}
<span class="co"># f = function(k,a){</span>
<span class="co">#   ck=sqrt(a^2*k/(k+1-a^2))</span>
<span class="co">#   pt(ck,df=k)</span>
<span class="co"># }</span>
solve_eq =<span class="st"> </span><span class="cf">function</span>(k){
  out=<span class="kw">uniroot</span>(<span class="cf">function</span>(a){<span class="kw">f</span>(k,a)<span class="op">-</span><span class="kw">f</span>(k<span class="op">-</span><span class="dv">1</span>,a)},<span class="dt">lower=</span><span class="dv">1</span>,<span class="dt">upper=</span><span class="dv">2</span>)
  out<span class="op">$</span>root
}
Root=<span class="kw">matrix</span>(<span class="dv">0</span>,<span class="dv">2</span>,<span class="dv">5</span>)
k=<span class="kw">c</span>(<span class="dv">4</span>,<span class="dv">25</span>,<span class="dv">100</span>,<span class="dv">500</span>,<span class="dv">1000</span>)
<span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(k)){
  Root[<span class="dv">2</span>,i]=<span class="kw">round</span>(<span class="kw">solve_eq</span>(k[i]),<span class="dv">4</span>)
}
Root[<span class="dv">1</span>,]=k;<span class="kw">rownames</span>(Root)=<span class="kw">c</span>(<span class="st">'k'</span>,<span class="st">'root'</span>)
Root</code></pre></div>
<pre><code>#        [,1]    [,2]     [,3]     [,4]      [,5]
# k    4.0000 25.0000 100.0000 500.0000 1000.0000
# root 1.4921  1.6874   1.7206   1.7298    1.7309</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Sk =<span class="st"> </span><span class="cf">function</span>(k,a){
 ck=<span class="kw">sqrt</span>(a<span class="op">^</span><span class="dv">2</span><span class="op">*</span>k<span class="op">/</span>(k<span class="op">+</span><span class="dv">1</span><span class="op">-</span>a<span class="op">^</span><span class="dv">2</span>))
 <span class="kw">pt</span>(ck,<span class="dt">df=</span>k,<span class="dt">lower.tail=</span><span class="ot">FALSE</span>)
}

solve_ist =<span class="st"> </span><span class="cf">function</span>(k){
  o=<span class="kw">uniroot</span>(<span class="cf">function</span>(a){<span class="kw">Sk</span>(k,a)<span class="op">-</span><span class="kw">Sk</span>(k<span class="op">-</span><span class="dv">1</span>,a)},<span class="dt">lower=</span><span class="dv">1</span>,<span class="dt">upper=</span><span class="dv">2</span>)
  o<span class="op">$</span>root
}
Ist=<span class="kw">matrix</span>(<span class="dv">0</span>,<span class="dv">2</span>,<span class="dv">5</span>)
k=<span class="kw">c</span>(<span class="dv">4</span>,<span class="dv">25</span>,<span class="dv">100</span>,<span class="dv">500</span>,<span class="dv">1000</span>)
<span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(k)){
  Ist[<span class="dv">2</span>,i]=<span class="kw">round</span>(<span class="kw">solve_ist</span>(k[i]),<span class="dv">4</span>)
}
Ist[<span class="dv">1</span>,]=k;<span class="kw">rownames</span>(Ist)=<span class="kw">c</span>(<span class="st">'k'</span>,<span class="st">'ist'</span>)
Ist</code></pre></div>
<pre><code>#       [,1]    [,2]     [,3]     [,4]      [,5]
# k   4.0000 25.0000 100.0000 500.0000 1000.0000
# ist 1.4921  1.6874   1.7206   1.7298    1.7309</code></pre>
<p>The results showed that the solutions to equation in 11.5 were the same as the points in Exercise 11.4.</p>
</div>
<div id="abo-blood-type-problem-the-frequencies-of-a-b-o-is-p-q-r.-observed-data-n_a28n_b24n_oo41n_ab70." class="section level4">
<h4>ABO Blood Type Problem: The frequencies of A, B, O is p, q, r. Observed data: <span class="math inline">\(n_A=28,n_B=24,n_{OO}=41,n_{AB}=70\)</span>.</h4>
<p><span class="math display">\[Observed\ data\ likelihood:\ L(p,q|...)=(p^2+2pr)^{n_{A.}}(q^2+2qr)^{n_{B.}}(r^2)^{n_{OO}}(2pq)^{n_{AB}}\]</span> <span class="math display">\[Complete\ data\ likelihood:\ L(p,q|...)=(p^2)^{n_{AA}}(q^2)^{n_{BB}}(r^2)^{n_{OO}}(2pr)^{n_{AO}}(2qr)^{n_{BO}}(2pq)^{n_{AB}}\]</span> Then take log and use <span class="math inline">\(n_{A.}-n_{AA}\)</span>,<span class="math inline">\(n_{B.}-n_{BB}\)</span> to replace <span class="math inline">\(n_{AO}\)</span> and <span class="math inline">\(n_{BO}\)</span>.</p>
<ol style="list-style-type: decimal">
<li>Use EM algorithm to solve MLE of p and q (consider missing data <span class="math inline">\(n_{AA}\)</span> and <span class="math inline">\(n_{BB}\)</span>)</li>
</ol>
<p><span class="math display">\[\hat{p_1}=\frac{n_{AB}+n_{A.}+n_{A.}\frac{\hat{p_0}^2}{\hat{p_0}^2+2\hat{p_0}\hat{r_0}}}{2n}\]</span> <span class="math display">\[\hat{q_1}=\frac{n_{AB}+n_{B.}+n_{B.}\frac{\hat{q_0}^2}{\hat{q_0}^2+2\hat{q_0}\hat{r_0}}}{2n}\]</span></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">5678</span>)
log_like =<span class="st"> </span><span class="cf">function</span>(p,q,r){
 p_t=p<span class="op">^</span><span class="dv">2</span><span class="op">/</span>(p<span class="op">^</span><span class="dv">2</span><span class="op">+</span><span class="dv">2</span><span class="op">*</span>p<span class="op">*</span>r);q_t=q<span class="op">^</span><span class="dv">2</span><span class="op">/</span>(q<span class="op">^</span><span class="dv">2</span><span class="op">+</span><span class="dv">2</span><span class="op">*</span>q<span class="op">*</span>r)
 l=n_A<span class="op">*</span><span class="kw">log</span>(<span class="dv">2</span><span class="op">*</span>p<span class="op">*</span>r)<span class="op">+</span>n_B<span class="op">*</span><span class="kw">log</span>(<span class="dv">2</span><span class="op">*</span>q<span class="op">*</span>r)<span class="op">+</span><span class="dv">2</span><span class="op">*</span>n_OO<span class="op">*</span><span class="kw">log</span>(r)<span class="op">+</span>n_AB<span class="op">*</span><span class="kw">log</span>(<span class="dv">2</span><span class="op">*</span>p<span class="op">*</span>q)<span class="op">+</span>
<span class="st">   </span>p_t<span class="op">*</span>n_A<span class="op">*</span><span class="kw">log</span>(p<span class="op">/</span><span class="dv">2</span><span class="op">/</span>r)<span class="op">+</span>q_t<span class="op">*</span>n_B<span class="op">*</span><span class="kw">log</span>(q<span class="op">/</span><span class="dv">2</span><span class="op">/</span>r)
 l
}
N =<span class="st"> </span><span class="dv">10000</span> 
B =<span class="st"> </span><span class="kw">c</span>(.<span class="dv">5</span>,.<span class="dv">4</span>,.<span class="dv">1</span>) 
tol =<span class="st"> </span>.Machine<span class="op">$</span>double.eps<span class="op">^</span><span class="fl">0.5</span>
n_A=<span class="dv">28</span>;n_B=<span class="dv">24</span>;n_OO=<span class="dv">41</span>;n_AB=<span class="dv">70</span>
n=n_A<span class="op">+</span>n_B<span class="op">+</span>n_OO<span class="op">+</span>n_AB
B.new=B;Log_l=<span class="kw">log_like</span>(B[<span class="dv">1</span>],B[<span class="dv">2</span>],B[<span class="dv">3</span>])
<span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N) {
 p_tmp=B[<span class="dv">1</span>]<span class="op">^</span><span class="dv">2</span><span class="op">/</span>(B[<span class="dv">1</span>]<span class="op">^</span><span class="dv">2</span><span class="op">+</span><span class="dv">2</span><span class="op">*</span>B[<span class="dv">1</span>]<span class="op">*</span>B[<span class="dv">3</span>])
 B[<span class="dv">1</span>]=(n_AB<span class="op">+</span>n_A<span class="op">+</span>n_A<span class="op">*</span>p_tmp)<span class="op">/</span>n<span class="op">/</span><span class="dv">2</span>
 q_tmp=B[<span class="dv">2</span>]<span class="op">^</span><span class="dv">2</span><span class="op">/</span>(B[<span class="dv">2</span>]<span class="op">^</span><span class="dv">2</span><span class="op">+</span><span class="dv">2</span><span class="op">*</span>B[<span class="dv">2</span>]<span class="op">*</span>B[<span class="dv">3</span>])
 B[<span class="dv">2</span>]=(n_AB<span class="op">+</span>n_B<span class="op">+</span>n_B<span class="op">*</span>q_tmp)<span class="op">/</span>n<span class="op">/</span><span class="dv">2</span>
 B[<span class="dv">3</span>]=<span class="dv">1</span><span class="op">-</span>B[<span class="dv">1</span>]<span class="op">-</span>B[<span class="dv">2</span>]
 <span class="cf">if</span> (<span class="kw">sum</span>(<span class="kw">abs</span>(B<span class="op">-</span>B.new)<span class="op">/</span>B.new)<span class="op">&lt;</span>tol) <span class="cf">break</span>
 B.new =<span class="st"> </span>B;Log_l=<span class="kw">c</span>(Log_l,<span class="kw">log_like</span>(B[<span class="dv">1</span>],B[<span class="dv">2</span>],B[<span class="dv">3</span>]))
}
<span class="kw">print</span>(<span class="kw">list</span>(<span class="dt">pqr =</span> B, <span class="dt">iter =</span> j, <span class="dt">tol =</span> tol))</code></pre></div>
<pre><code># $pqr
# [1] 0.3273442 0.3104267 0.3622291
# 
# $iter
# [1] 11
# 
# $tol
# [1] 1.490116e-08</code></pre>
<ol start="2" style="list-style-type: decimal">
<li>Show that the log-maximum likelihood values in M-steps are increasing via line plot.<br />
<span class="math display">\[Log-max\ likelihood:\ l(p,q|...)=n_{A.}log(2pr)+n_{B.}log(2qr)+2n_{OO}log(r)+n_{AB}log(2pq)\]</span> <span class="math display">\[+\frac{p^2}{p^2+2pr}n_{A.}log(\frac{p}{2r})+\frac{q^2}{q^2+2qr}n_{B.}log(\frac{q}{2r})\]</span> All p,q,r use the estimated values in M-steps.</li>
</ol>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(<span class="dv">1</span><span class="op">:</span>j,Log_l,<span class="dt">type=</span><span class="st">'l'</span>,<span class="dt">xlab=</span><span class="st">'iteration'</span>,<span class="dt">ylab=</span><span class="st">'log-likelihood'</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>We can see that the log-maximum likelihood values in M-steps are increasing.</p>
</div>
</div>
<div id="homework-11-12.13" class="section level3">
<h3>Homework-11 12.13</h3>
<div id="advanced-r-p204-3.use-both-for-loops-and-lapply-to-fit-linear-models-to-mtcars-using-the-formulas-stored-in-this-list-formulas---listmpg-disp-mpg-i1-dispmpg-disp-wtmpg-i1-disp-wt." class="section level4">
<h4>(Advanced R p204) 3.Use both for loops and lapply() to fit linear models to <em>mtcars</em> using the formulas stored in this list: formulas &lt;- list(mpg ~ disp, mpg ~ I(1 / disp),mpg ~ disp + wt,mpg ~ I(1 / disp) + wt).</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">attach</span>(mtcars)
formulas=<span class="kw">list</span>(
 mpg <span class="op">~</span><span class="st"> </span>disp,
 mpg <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>disp),
 mpg <span class="op">~</span><span class="st"> </span>disp <span class="op">+</span><span class="st"> </span>wt,
 mpg <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>disp) <span class="op">+</span><span class="st"> </span>wt
)
<span class="co">#Loop</span>
n=<span class="kw">length</span>(formulas)
out=<span class="kw">vector</span>(<span class="st">&quot;list&quot;</span>,n)
<span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n){
 out[[i]]=<span class="kw">lm</span>(formulas[[i]],<span class="dt">data=</span>mtcars)
}
out</code></pre></div>
<pre><code># [[1]]
# 
# Call:
# lm(formula = formulas[[i]], data = mtcars)
# 
# Coefficients:
# (Intercept)         disp  
#    29.59985     -0.04122  
# 
# 
# [[2]]
# 
# Call:
# lm(formula = formulas[[i]], data = mtcars)
# 
# Coefficients:
# (Intercept)    I(1/disp)  
#       10.75      1557.67  
# 
# 
# [[3]]
# 
# Call:
# lm(formula = formulas[[i]], data = mtcars)
# 
# Coefficients:
# (Intercept)         disp           wt  
#    34.96055     -0.01772     -3.35083  
# 
# 
# [[4]]
# 
# Call:
# lm(formula = formulas[[i]], data = mtcars)
# 
# Coefficients:
# (Intercept)    I(1/disp)           wt  
#      19.024     1142.560       -1.798</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#lapply</span>
<span class="kw">lapply</span>(formulas,lm)</code></pre></div>
<pre><code># [[1]]
# 
# Call:
# FUN(formula = X[[i]])
# 
# Coefficients:
# (Intercept)         disp  
#    29.59985     -0.04122  
# 
# 
# [[2]]
# 
# Call:
# FUN(formula = X[[i]])
# 
# Coefficients:
# (Intercept)    I(1/disp)  
#       10.75      1557.67  
# 
# 
# [[3]]
# 
# Call:
# FUN(formula = X[[i]])
# 
# Coefficients:
# (Intercept)         disp           wt  
#    34.96055     -0.01772     -3.35083  
# 
# 
# [[4]]
# 
# Call:
# FUN(formula = X[[i]])
# 
# Coefficients:
# (Intercept)    I(1/disp)           wt  
#      19.024     1142.560       -1.798</code></pre>
<p>Lapply greatly simplified the code.</p>
</div>
<div id="fit-the-model-mpg-disp-to-each-of-the-bootstrap-replicates-of-mtcars-in-the-list-below-by-using-a-for-loop-and-lapply.-can-you-do-it-without-an-anonymous-function-bootstraps---lapply110-functioni-rows---sample1nrowmtcars-rep-truemtcarsrows" class="section level4">
<h4>4.Fit the model <em>mpg ~ disp</em> to each of the bootstrap replicates of mtcars in the list below by using a for loop and lapply(). Can you do it without an anonymous function? bootstraps &lt;- lapply(1:10, function(i) {rows &lt;- sample(1:nrow(mtcars), rep = TRUE);mtcars[rows, ]})</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">bootstraps =<span class="st"> </span><span class="kw">lapply</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>, <span class="cf">function</span>(i) {
 rows =<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(mtcars), <span class="dt">rep =</span> <span class="ot">TRUE</span>)
 mtcars[rows, ]
})
oUt=<span class="kw">vector</span>(<span class="st">&quot;list&quot;</span>,<span class="dv">10</span>)
<span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">10</span>) oUt[[i]]=<span class="kw">lm</span>(mpg <span class="op">~</span><span class="st"> </span>disp,<span class="dt">data=</span>bootstraps[[i]])
oUt[<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>]<span class="co">#Only print results 1-3  </span></code></pre></div>
<pre><code># [[1]]
# 
# Call:
# lm(formula = mpg ~ disp, data = bootstraps[[i]])
# 
# Coefficients:
# (Intercept)         disp  
#     28.9321      -0.0344  
# 
# 
# [[2]]
# 
# Call:
# lm(formula = mpg ~ disp, data = bootstraps[[i]])
# 
# Coefficients:
# (Intercept)         disp  
#    28.28648     -0.03866  
# 
# 
# [[3]]
# 
# Call:
# lm(formula = mpg ~ disp, data = bootstraps[[i]])
# 
# Coefficients:
# (Intercept)         disp  
#    27.81481     -0.03468</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Out=<span class="kw">lapply</span>(<span class="kw">seq_along</span>(bootstraps), <span class="cf">function</span>(i){
 <span class="kw">lm</span>(mpg <span class="op">~</span><span class="st"> </span>disp,<span class="dt">data=</span>bootstraps[[i]])})
Out[<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>]<span class="co">#Only print resuls 1-3</span></code></pre></div>
<pre><code># [[1]]
# 
# Call:
# lm(formula = mpg ~ disp, data = bootstraps[[i]])
# 
# Coefficients:
# (Intercept)         disp  
#     28.9321      -0.0344  
# 
# 
# [[2]]
# 
# Call:
# lm(formula = mpg ~ disp, data = bootstraps[[i]])
# 
# Coefficients:
# (Intercept)         disp  
#    28.28648     -0.03866  
# 
# 
# [[3]]
# 
# Call:
# lm(formula = mpg ~ disp, data = bootstraps[[i]])
# 
# Coefficients:
# (Intercept)         disp  
#    27.81481     -0.03468</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">OUT=<span class="kw">lapply</span>(bootstraps,lm,<span class="dt">formula =</span> mpg <span class="op">~</span><span class="st"> </span>disp)<span class="co">#No anonymous function</span>
OUT[<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>]</code></pre></div>
<pre><code># [[1]]
# 
# Call:
# FUN(formula = ..1, data = X[[i]])
# 
# Coefficients:
# (Intercept)         disp  
#     28.9321      -0.0344  
# 
# 
# [[2]]
# 
# Call:
# FUN(formula = ..1, data = X[[i]])
# 
# Coefficients:
# (Intercept)         disp  
#    28.28648     -0.03866  
# 
# 
# [[3]]
# 
# Call:
# FUN(formula = ..1, data = X[[i]])
# 
# Coefficients:
# (Intercept)         disp  
#    27.81481     -0.03468</code></pre>
</div>
<div id="for-each-model-in-the-previous-two-exercises-extract-r2-using-the-function-below.rsq---functionmod-summarymodr.squared" class="section level4">
<h4>5.For each model in the previous two exercises, extract <span class="math inline">\(R^2\)</span> using the function below.<em>rsq &lt;- function(mod) summary(mod)$r.squared</em></h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">rsq =<span class="st"> </span><span class="cf">function</span>(mod) <span class="kw">summary</span>(mod)<span class="op">$</span>r.squared
<span class="kw">unlist</span>(<span class="kw">lapply</span>(out,rsq)) <span class="co">#Model in Ex3</span></code></pre></div>
<pre><code># [1] 0.7183433 0.8596865 0.7809306 0.8838038</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">unlist</span>(<span class="kw">lapply</span>(Out,rsq)) <span class="co">#Model in Ex4</span></code></pre></div>
<pre><code>#  [1] 0.6051657 0.7566569 0.6627608 0.5015128 0.6755955 0.4728488 0.6333239
#  [8] 0.8088145 0.7088271 0.7347190</code></pre>
</div>
<div id="advanced-r-p214-3.the-following-code-simulates-the-performance-of-a-t-test-for-non-normal-data.-use-sapply-and-an-anonymous-function-to-extract-the-p-value-from-every-trial.-extra-challenge-get-rid-of-the-anonymous-function-by-using-directly." class="section level4">
<h4>(Advanced R p214) 3.The following code simulates the performance of a t-test for <strong>non-normal data</strong>. Use sapply() and an anonymous function to extract the p-value from every trial. Extra challenge: get rid of the anonymous function by using [[ directly.</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">trials=<span class="kw">replicate</span>(<span class="dv">100</span>,<span class="kw">t.test</span>(<span class="kw">rpois</span>(<span class="dv">10</span>, <span class="dv">10</span>),<span class="kw">rpois</span>(<span class="dv">7</span>, <span class="dv">10</span>)),<span class="dt">simplify =</span> <span class="ot">FALSE</span>)
<span class="kw">sapply</span>(trials,<span class="cf">function</span>(mod){mod<span class="op">$</span>p.value})</code></pre></div>
<pre><code>#   [1] 0.854288772 0.776334954 0.370789698 0.254979803 0.811603063 0.028079273
#   [7] 0.649711892 0.434531780 0.891273190 0.042915185 0.890206344 0.608996498
#  [13] 0.496542554 0.410296543 0.250665798 0.341600298 0.145950799 0.688830329
#  [19] 0.566152803 0.402954915 0.883956370 0.724610866 0.265818655 0.644627394
#  [25] 0.256221905 0.289638303 0.993297520 0.676970292 0.811367326 0.080222324
#  [31] 0.706243740 0.309552055 0.452811992 0.495510437 0.633858083 0.409733737
#  [37] 0.309375911 0.356375425 0.152410255 0.645835507 0.416984276 0.841993824
#  [43] 0.567374815 0.865801453 0.796645420 0.619311076 0.073065575 0.729402131
#  [49] 0.366085134 0.139292043 0.901932719 0.533740922 0.769470531 0.058370972
#  [55] 0.009536885 0.431052114 0.250029688 0.450036163 0.596520296 0.078942651
#  [61] 0.835594047 0.450736733 0.675191105 0.035830535 0.975642061 0.387342202
#  [67] 0.601369248 0.937847046 0.635831332 0.183019344 0.821148151 0.618357172
#  [73] 0.023333956 0.068128671 0.036874337 0.173842969 0.426708362 0.660427950
#  [79] 0.562867648 0.426984074 0.937914838 0.207513996 0.850624106 0.758820255
#  [85] 0.124999984 0.701233975 0.044936107 0.235225300 0.793678445 0.036966658
#  [91] 0.976243908 0.239724062 0.780787173 0.123900104 0.427564920 0.448568893
#  [97] 0.132116403 0.959456559 0.484992396 0.751021216</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">sapply</span>(trials, <span class="st">&quot;[[&quot;</span>, <span class="st">&quot;p.value&quot;</span>) <span class="co">#No anonymous function</span></code></pre></div>
<pre><code>#   [1] 0.854288772 0.776334954 0.370789698 0.254979803 0.811603063 0.028079273
#   [7] 0.649711892 0.434531780 0.891273190 0.042915185 0.890206344 0.608996498
#  [13] 0.496542554 0.410296543 0.250665798 0.341600298 0.145950799 0.688830329
#  [19] 0.566152803 0.402954915 0.883956370 0.724610866 0.265818655 0.644627394
#  [25] 0.256221905 0.289638303 0.993297520 0.676970292 0.811367326 0.080222324
#  [31] 0.706243740 0.309552055 0.452811992 0.495510437 0.633858083 0.409733737
#  [37] 0.309375911 0.356375425 0.152410255 0.645835507 0.416984276 0.841993824
#  [43] 0.567374815 0.865801453 0.796645420 0.619311076 0.073065575 0.729402131
#  [49] 0.366085134 0.139292043 0.901932719 0.533740922 0.769470531 0.058370972
#  [55] 0.009536885 0.431052114 0.250029688 0.450036163 0.596520296 0.078942651
#  [61] 0.835594047 0.450736733 0.675191105 0.035830535 0.975642061 0.387342202
#  [67] 0.601369248 0.937847046 0.635831332 0.183019344 0.821148151 0.618357172
#  [73] 0.023333956 0.068128671 0.036874337 0.173842969 0.426708362 0.660427950
#  [79] 0.562867648 0.426984074 0.937914838 0.207513996 0.850624106 0.758820255
#  [85] 0.124999984 0.701233975 0.044936107 0.235225300 0.793678445 0.036966658
#  [91] 0.976243908 0.239724062 0.780787173 0.123900104 0.427564920 0.448568893
#  [97] 0.132116403 0.959456559 0.484992396 0.751021216</code></pre>
<p>Using sapply greatly simplified the code.</p>
</div>
<div id="implement-mcsapply-a-multicore-version-of-sapply.-can-you-implement-mcvapply-a-parallel-version-of-vapply-why-or-why-not" class="section level4">
<h4>7.Implement mcsapply(), a multicore version of sapply(). Can you implement mcvapply(), a parallel version of vapply()? Why or why not?</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(parallel)
cores =<span class="st"> </span><span class="kw">detectCores</span>()
cluster =<span class="st"> </span><span class="kw">makePSOCKcluster</span>(cores)
mcsapply =<span class="st"> </span><span class="cf">function</span>(cluster,X,FUN,...){
 res=<span class="kw">parLapply</span>(cluster,X,FUN,...) <span class="co">#Use parLapply in Windows</span>
 <span class="kw">simplify2array</span>(res)
}
<span class="co">#Example of Parallelisation</span>
boot_i =<span class="st"> </span><span class="cf">function</span>(i){
 r_adj =<span class="st"> </span><span class="cf">function</span>(x,id) {
  x =<span class="st"> </span>x[id,]     <span class="co">#bootstrap sample</span>
  res =<span class="st"> </span><span class="kw">lm</span>(mpg<span class="op">~</span>wt<span class="op">+</span>disp,<span class="dt">data=</span>x)
  <span class="kw">summary</span>(res)<span class="op">$</span>adj.r.squared
}
 <span class="kw">as.numeric</span>(boot<span class="op">::</span><span class="kw">boot</span>(mtcars,r_adj,<span class="dv">1</span>)<span class="op">$</span>t)
}
<span class="kw">system.time</span>(<span class="kw">sapply</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">500</span>,boot_i))</code></pre></div>
<pre><code>#    user  system elapsed 
#    1.97    0.02    2.18</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">system.time</span>(<span class="kw">mcsapply</span>(cluster,<span class="dv">1</span><span class="op">:</span><span class="dv">500</span>,boot_i))</code></pre></div>
<pre><code>#    user  system elapsed 
#    0.00    0.00    0.61</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#In fact, in Windows, we have function *parSapply* directly.</span></code></pre></div>
<p>We can see that using parallelisation, the system time for running bootstrap decrease sharply. I can implement mcvapply, it is just the same as mcsapply, just with additional argument specifying the output type.</p>
</div>
</div>
<div id="homework-12-12.20" class="section level3">
<h3>Homework-12 12.20</h3>
<div id="you-have-already-written-an-r-function-for-exercise-9.4-page-277-statistical-computing-with-r.-rewrite-an-rcpp-function-for-the-same-task." class="section level4">
<h4>1.You have already written an R function for Exercise 9.4 (page 277, Statistical Computing with R). Rewrite an Rcpp function for the same task.</h4>
<pre eval="FALSE"><code>#include &lt;cmath&gt;
#include &lt;Rcpp.h&gt;
using namespace Rcpp;

//[[Rcpp::export]]
double f(double x) {
    return exp(-fabs(x));
}

//[[Rcpp::export]]
List randomMHC (double sigma, double x0, int N) {
    NumericVector x(N);
    x[0] = x0;  //index start from 0
    NumericVector u = runif(N);
    int rej = 0;
        for (int i = 1; i &lt; N;i++ ) {
            NumericVector y = rnorm(1, x[i-1], sigma);
            if (u[i] &lt;= (f(y[0]) / f(x[i - 1])))
                {
                    x[i] = y[0];
                }
            else 
                { 
                    x[i] = x[i-1]; 
                    rej ++;
                }
        }
        return List::create(Named(&quot;x&quot;) = x, Named(&quot;rej&quot;) = rej);
}
</code></pre>
<p>I rewrite the random Metropolis-Hastings Rcpp function named <em>randomMHC</em> as above. For Exercise 9.4, one needs to use different sigma, but in fact the mechanism is the same. I just take sigma=2 as an example here.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(Rcpp)
<span class="kw">set.seed</span>(<span class="dv">1278</span>)
<span class="kw">sourceCpp</span>(<span class="st">'C:/Users/H.X.X/Desktop/Statistical Computing/A-19090-2019-12-20/randomMHC.cpp'</span>)
N=<span class="dv">2000</span>;sigma=<span class="dv">2</span>;x0=<span class="dv">20</span>
C=<span class="kw">randomMHC</span>(sigma,x0,N) <span class="co">#Samples generated by Cpp function</span>
<span class="kw">paste</span>(<span class="st">'Rej='</span>,C<span class="op">$</span>rej)</code></pre></div>
<pre><code># [1] &quot;Rej= 957&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(<span class="dv">1</span><span class="op">:</span>N,C<span class="op">$</span>x,<span class="dt">type=</span><span class="st">'l'</span>,<span class="dt">xlab=</span><span class="st">'N'</span>,<span class="dt">ylab=</span><span class="st">'Samples'</span>,<span class="dt">main=</span><span class="st">'RW Metropolis sampler for generating Laplace dist'</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Using <em>sourceCpp</em> we can see that the Cpp function really works in R.</p>
</div>
<div id="compare-the-generated-random-numbers-by-the-two-functions-using-qqplot" class="section level4">
<h4>2.Compare the generated random numbers by the two functions using qqplot</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">1278</span>)
f =<span class="st"> </span><span class="cf">function</span>(x) {
  <span class="kw">return</span>(<span class="kw">exp</span>(<span class="op">-</span><span class="kw">abs</span>(x)))
}
random.M =<span class="st"> </span><span class="cf">function</span>(sigma, x0, N){
 x =<span class="st"> </span><span class="kw">numeric</span>(N)
 x[<span class="dv">1</span>] =<span class="st"> </span>x0
 u =<span class="st"> </span><span class="kw">runif</span>(N)
 rej =<span class="st"> </span><span class="dv">0</span>
 <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>N) {
  y =<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1</span>, x[i<span class="op">-</span><span class="dv">1</span>], sigma)
  <span class="cf">if</span> (u[i] <span class="op">&lt;=</span><span class="st"> </span>(<span class="kw">f</span>(y) <span class="op">/</span><span class="st"> </span><span class="kw">f</span>(x[i<span class="op">-</span><span class="dv">1</span>]))) x[i] =<span class="st"> </span>y 
  <span class="cf">else</span> {x[i] =<span class="st"> </span>x[i<span class="op">-</span><span class="dv">1</span>];rej=rej<span class="op">+</span><span class="dv">1</span>}
 }
 <span class="kw">return</span>(<span class="kw">list</span>(<span class="dt">x=</span>x, <span class="dt">rej=</span>rej))
}
R=<span class="kw">random.M</span>(sigma,x0,N) <span class="co">#Samples generated by R function</span>
<span class="kw">library</span>(rmutil,<span class="dt">quietly=</span><span class="ot">TRUE</span>)
p =<span class="st"> </span><span class="kw">c</span>(.<span class="dv">05</span>, <span class="kw">seq</span>(.<span class="dv">1</span>, .<span class="dv">9</span>, .<span class="dv">1</span>), .<span class="dv">95</span>)
real=<span class="kw">rlaplace</span>(N) <span class="co">#Real examples of Laplace distribution </span>
Ex =<span class="st"> </span><span class="kw">cbind</span>(C<span class="op">$</span>x, R<span class="op">$</span>x)
Mc =<span class="st"> </span>Ex[<span class="dv">501</span><span class="op">:</span>N, ] <span class="co">#burn in the first 500 samples</span>
QR =<span class="st"> </span><span class="kw">apply</span>(Mc, <span class="dv">2</span>, <span class="cf">function</span>(x) <span class="kw">quantile</span>(x, p))
<span class="co"># par(mfrow=c(1,3))</span>
<span class="co"># qqplot(Mc[,1],real,pch=20,col='red',main='Samples generated by Cpp');</span>
<span class="co"># qqline(Mc[,1],distribution=qlaplace,lwd=1.9)</span>
<span class="co"># qqplot(Mc[,2],real,pch=20,col='red',main='Samples generated by R');</span>
<span class="co"># qqline(Mc[,2],distribution=qlaplace,lwd=1.9)</span>
<span class="kw">qqplot</span>(Mc[,<span class="dv">1</span>],Mc[,<span class="dv">2</span>],<span class="dt">xlab=</span><span class="st">'Samples generated by Cpp'</span>,<span class="dt">ylab=</span><span class="st">'Samples generated by R'</span>,<span class="dt">col=</span><span class="st">'red'</span>,<span class="dt">pch=</span><span class="dv">20</span>)
<span class="kw">abline</span>(<span class="dt">a=</span><span class="dv">0</span>,<span class="dt">b=</span><span class="dv">1</span>,<span class="dt">col=</span><span class="st">'black'</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Th dots of qqplot are located on the diagonal lines. Therefore, with fixed seed, we can see that samples generated by two functions are the same. There is no any difference in generating samples between the two functions. (You can run the commented codes to see that both of the samples are close to the real distribution)</p>
</div>
<div id="campare-the-computation-time-of-the-two-functions-with-microbenchmark." class="section level4">
<h4>3.Campare the computation time of the two functions with <em>microbenchmark</em>.</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(microbenchmark)
time =<span class="st"> </span><span class="kw">microbenchmark</span>(<span class="dt">MHC=</span><span class="kw">randomMHC</span>(sigma,x0,N),<span class="dt">MHR=</span><span class="kw">random.M</span>(sigma,x0,N))
<span class="kw">summary</span>(time)[,<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">6</span>)]</code></pre></div>
<pre><code>#   expr      lq  median       uq
# 1  MHC  453.75   494.2   689.05
# 2  MHR 8369.40 10319.7 12256.40</code></pre>
<p>We can see that using Cpp function, the running time is much shorter than using R function, almost 1/15 of before. Therefore, using Rcpp method can greatly shorter the consuming time for calculations.</p>
</div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
